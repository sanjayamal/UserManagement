{"ast":null,"code":"var _jsxFileName = \"D:\\\\Assignment\\\\graph-tutorial\\\\UserManagement\\\\src\\\\Users.tsx\";\nimport React, { useState, useEffect } from 'react';\nimport { config } from './Config';\nimport { UserAgentApplication } from 'msal';\nimport { getUser, deleteUser, updateUser } from './GraphService';\nimport { Table, Button, Drawer, Form, Input, Popconfirm, message } from 'antd';\nimport 'antd/dist/antd.css';\n\nconst User = () => {\n  const [users, setUser] = useState([]);\n  const [drawerVisible, setDrawerVisible] = useState(false);\n  const [user, setOneUser] = useState();\n  const [deleteConfitmation, setConfirmation] = useState(false);\n  useEffect(() => {\n    getUserService().then(result => {\n      console.log(result);\n    });\n  }, [user]);\n  const columns = [{\n    title: 'Display Name',\n    dataIndex: 'displayName',\n    key: 'displayName'\n  }, {\n    title: 'Mail',\n    dataIndex: 'mail',\n    key: 'mail'\n  }, {\n    title: '',\n    dataIndex: 'id',\n    key: 'id',\n    render: (key, test) => /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Button, {\n      style: {\n        'marginRight': '3px'\n      },\n      onClick: () => userUpdate(test),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 37,\n        columnNumber: 17\n      }\n    }, \"Update\"), /*#__PURE__*/React.createElement(Popconfirm, {\n      title: \"Are you sure delete this task?\",\n      onConfirm: confirmDelete,\n      onCancel: cancelDelete,\n      okText: \"Yes\",\n      cancelText: \"No\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 38,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(Button, {\n      onClick: () => {\n        userDelete(key);\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 44,\n        columnNumber: 17\n      }\n    }, \"Delete\")))\n  }];\n  const userAgentApplication = new UserAgentApplication({\n    auth: {\n      clientId: config.appId,\n      redirectUri: config.redirectUri\n    },\n    cache: {\n      cacheLocation: \"sessionStorage\",\n      storeAuthStateInCookie: true\n    }\n  });\n\n  const getAccessToken = async scopes => {\n    try {\n      var silentResult = await userAgentApplication.acquireTokenSilent({\n        scopes: scopes\n      });\n      return silentResult.accessToken;\n    } catch (err) {\n      // If a silent request fails, it may be because the user needs\n      // to login or grant consent to one or more of the requested scopes\n      if (isInteractionRequired(err)) {\n        var interactiveResult = await userAgentApplication.acquireTokenPopup({\n          scopes: scopes\n        });\n        return interactiveResult.accessToken;\n      } else {\n        throw err;\n      }\n    }\n  };\n\n  const getUserService = async () => {\n    const accessToken = await getAccessToken(config.scopes);\n    getUser(accessToken).then(result => {\n      const {\n        value\n      } = result;\n      setUser(value);\n      console.log(value);\n    });\n  };\n\n  const confirmDelete = e => {\n    setConfirmation(true);\n    message.success('Click on Yes');\n  };\n\n  const cancelDelete = e => {\n    setConfirmation(false);\n    message.success('Click on no');\n  };\n\n  const userDelete = async id => {\n    const data = users.filter(user => user.id !== id);\n    setUser(data);\n    const accessToken = await getAccessToken(config.scopes);\n    deleteUser(accessToken, id).then(res => console.log(res)).catch(res => console.log(res));\n  };\n\n  const userUpdate = user => {\n    setDrawerVisible(true);\n    setOneUser(user);\n  };\n\n  const userUpdateSave = async values => {\n    const accessToken = await getAccessToken(config.scopes);\n    values.id = values.id !== undefined ? values.id : user.id !== null ? user.id : '';\n    values.displayName = values.displayName !== undefined || null ? values.displayName : user.displayName !== null ? user.displayName : '';\n    values.givenName = values.givenName !== undefined || null ? values.givenName : user.givenName !== null ? user.givenName : null;\n    values.jobTitle = values.jobTitle !== undefined || null ? values.jobTitle : user.jobTitle !== null ? user.jobTitle : null;\n    values.mobilePhone = values.mobilePhone !== undefined || null ? values.mobilePhone : user.mobilePhone !== null ? user.mobilePhone : null;\n    values.officeLocation = values.officeLocation !== undefined || null ? values.officeLocation : user.officeLocation !== null ? user.officeLocation : null;\n    values.surname = values.surname !== undefined || null ? values.surname : user.surname !== null ? user.surname : null;\n    values.userPrincipalName = values.userPrincipalName !== undefined || null ? values.userPrincipalName : user.userPrincipalName !== null ? user.userPrincipalName : null;\n    values.mail = values.mail !== undefined || null ? values.mail : user.mail !== null ? user.mail : null;\n    updateUser(accessToken, values).then(res => {\n      setDrawerVisible(false);\n      setOneUser(values);\n    });\n  };\n\n  const onClose = () => {\n    setDrawerVisible(false);\n  };\n\n  const isInteractionRequired = error => {\n    if (!error.message || error.message.length <= 0) {\n      return false;\n    }\n\n    return error.message.indexOf('consent_required') > -1 || error.message.indexOf('interaction_required') > -1 || error.message.indexOf('login_required') > -1;\n  };\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Button, {\n    href: \"/adduser\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 162,\n      columnNumber: 13\n    }\n  }, \"Create New User\"), /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 163,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(Table, {\n    dataSource: users,\n    columns: columns,\n    style: {\n      'paddingTop': '10px'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 164,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(Drawer, {\n    title: \"Create a new account\",\n    width: 720,\n    onClose: onClose,\n    visible: drawerVisible,\n    bodyStyle: {\n      paddingBottom: 80\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 166,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Form, {\n    onFinish: userUpdateSave,\n    initialValues: {\n      'displayName': user === undefined ? '' : user.displayName !== null ? user.displayName : '',\n      'givenName': user === undefined ? '' : user.givenName !== null ? user.givenName : '',\n      'id': user === undefined ? '' : user.id !== null ? user.id : '',\n      'jobTitle': user === undefined ? '' : user.jobTitle !== null ? user.jobTitle : '',\n      'mobilePhone': user === undefined ? '' : user.mobilePhone !== null ? user.mobilePhone : '',\n      'officeLocation': user === undefined ? '' : user.officeLocation !== null ? user.officeLocation : '',\n      'surname': user === undefined ? '' : user.surname !== null ? user.surname : '',\n      'userPrincipalName': user === undefined ? '' : user.userPrincipalName !== null ? user.userPrincipalName : '',\n      'mail': user === undefined ? '' : user.mail !== null ? user.mail : ''\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(Form.Item, {\n    label: \"Display Name\",\n    name: \"displayName\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(Input, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 194,\n      columnNumber: 25\n    }\n  })), /*#__PURE__*/React.createElement(Form.Item, {\n    label: \"Email\",\n    name: \"mail\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 196,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(Input, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 200,\n      columnNumber: 25\n    }\n  })), /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 202,\n      columnNumber: 21\n    }\n  }), /*#__PURE__*/React.createElement(Form.Item, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 203,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    type: \"primary\",\n    htmlType: \"submit\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 204,\n      columnNumber: 25\n    }\n  }, \"update\"), /*#__PURE__*/React.createElement(Button, {\n    onClick: onClose,\n    type: \"default\",\n    htmlType: \"submit\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 207,\n      columnNumber: 25\n    }\n  }, \"Cancel\")))));\n};\n\nexport default User;","map":{"version":3,"sources":["D:/Assignment/graph-tutorial/UserManagement/src/Users.tsx"],"names":["React","useState","useEffect","config","UserAgentApplication","getUser","deleteUser","updateUser","Table","Button","Drawer","Form","Input","Popconfirm","message","User","users","setUser","drawerVisible","setDrawerVisible","user","setOneUser","deleteConfitmation","setConfirmation","getUserService","then","result","console","log","columns","title","dataIndex","key","render","test","userUpdate","confirmDelete","cancelDelete","userDelete","userAgentApplication","auth","clientId","appId","redirectUri","cache","cacheLocation","storeAuthStateInCookie","getAccessToken","scopes","silentResult","acquireTokenSilent","accessToken","err","isInteractionRequired","interactiveResult","acquireTokenPopup","value","e","success","id","data","filter","res","catch","userUpdateSave","values","undefined","displayName","givenName","jobTitle","mobilePhone","officeLocation","surname","userPrincipalName","mail","onClose","error","length","indexOf","paddingBottom"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { config } from './Config';\r\nimport { UserAgentApplication } from 'msal';\r\nimport { getUser, deleteUser, updateUser } from './GraphService';\r\nimport { Table, Button, Drawer, Form, Input, Popconfirm, message } from 'antd';\r\nimport 'antd/dist/antd.css';\r\n\r\nconst User = () => {\r\n\r\n    const [users, setUser] = useState<any>([]);\r\n    const [drawerVisible, setDrawerVisible] = useState<boolean>(false)\r\n    const [user, setOneUser] = useState<any>();\r\n    const [deleteConfitmation,setConfirmation]=useState<boolean>(false);\r\n\r\n    useEffect(() => {\r\n        getUserService().then(result => {\r\n            console.log(result)\r\n        });\r\n    }, [user]);\r\n\r\n    const columns = [\r\n        {\r\n            title: 'Display Name',\r\n            dataIndex: 'displayName',\r\n            key: 'displayName',\r\n        },\r\n        {\r\n            title: 'Mail',\r\n            dataIndex: 'mail',\r\n            key: 'mail',\r\n        },\r\n        {\r\n            title: '',\r\n            dataIndex: 'id',\r\n            key: 'id',\r\n            render: (key: any, test: any) => <>\r\n                <Button style={{ 'marginRight': '3px' }} onClick={() => userUpdate(test)}>Update</Button>\r\n                <Popconfirm\r\n                    title=\"Are you sure delete this task?\"\r\n                    onConfirm={confirmDelete}\r\n                    onCancel={cancelDelete}\r\n                    okText=\"Yes\"\r\n                    cancelText=\"No\">\r\n                <Button onClick={() => { userDelete(key) }}>Delete</Button>\r\n                </Popconfirm>\r\n            </>,\r\n        },\r\n\r\n    ];\r\n\r\n    const userAgentApplication = new UserAgentApplication({\r\n        auth: {\r\n            clientId: config.appId,\r\n            redirectUri: config.redirectUri\r\n        },\r\n        cache: {\r\n            cacheLocation: \"sessionStorage\",\r\n            storeAuthStateInCookie: true\r\n        }\r\n    });\r\n\r\n\r\n    const getAccessToken = async (scopes: string[]) => {\r\n\r\n        try {\r\n            var silentResult = await userAgentApplication.acquireTokenSilent({\r\n                scopes: scopes\r\n            });\r\n            return silentResult.accessToken;\r\n        } catch (err) {\r\n            // If a silent request fails, it may be because the user needs\r\n            // to login or grant consent to one or more of the requested scopes\r\n            if (isInteractionRequired(err)) {\r\n                var interactiveResult = await userAgentApplication.acquireTokenPopup({\r\n                    scopes: scopes\r\n                });\r\n\r\n                return interactiveResult.accessToken;\r\n            } else {\r\n                throw err;\r\n            }\r\n        }\r\n    }\r\n\r\n    const getUserService = async () => {\r\n        const accessToken = await getAccessToken(config.scopes);\r\n        getUser(accessToken)\r\n            .then((result: any) => {\r\n                const { value } = result;\r\n                setUser(value)\r\n                console.log(value)\r\n            });\r\n\r\n    }\r\n    const confirmDelete = (e: any) => {\r\n        setConfirmation(true);\r\n        message.success('Click on Yes');\r\n    }\r\n    const cancelDelete = (e: any) => {\r\n        setConfirmation(false);\r\n        message.success('Click on no');\r\n    }\r\n\r\n    const userDelete = async (id: any) => {\r\n        const data = users.filter((user: any) => user.id !== id)\r\n        setUser(data)\r\n        const accessToken = await getAccessToken(config.scopes);\r\n        deleteUser(accessToken, id)\r\n            .then(res => console.log(res))\r\n            .catch(res => console.log(res));\r\n    }\r\n\r\n    const userUpdate = (user: any) => {\r\n        setDrawerVisible(true);\r\n        setOneUser(user)\r\n\r\n    }\r\n\r\n\r\n    const userUpdateSave = async (values: any) => {\r\n\r\n        const accessToken = await getAccessToken(config.scopes);\r\n        values.id = values.id !== undefined ? values.id : (user.id !== null ? user.id : '');\r\n        values.displayName = values.displayName !== undefined || null ? values.displayName : (user.displayName !== null ? user.displayName : '');\r\n        values.givenName = values.givenName !== undefined || null ? values.givenName : (user.givenName !== null ? user.givenName : null);\r\n        values.jobTitle = values.jobTitle !== undefined || null ? values.jobTitle : (user.jobTitle !== null ? user.jobTitle : null);\r\n        values.mobilePhone = values.mobilePhone !== undefined || null ? values.mobilePhone : (user.mobilePhone !== null ? user.mobilePhone : null);\r\n        values.officeLocation = values.officeLocation !== undefined || null ? values.officeLocation : (user.officeLocation !== null ? user.officeLocation : null);\r\n        values.surname = values.surname !== undefined || null ? values.surname : (user.surname !== null ? user.surname : null);\r\n        values.userPrincipalName = values.userPrincipalName !== undefined || null ? values.userPrincipalName : (user.userPrincipalName !== null ? user.userPrincipalName : null);\r\n        values.mail = values.mail !== undefined || null ? values.mail : (user.mail !== null ? user.mail : null);\r\n\r\n        updateUser(accessToken, values)\r\n            .then((res: any) => {\r\n                setDrawerVisible(false);\r\n                setOneUser(values)\r\n            })\r\n    }\r\n\r\n    const onClose = () => {\r\n        setDrawerVisible(false)\r\n    }\r\n\r\n    const isInteractionRequired = (error: Error): boolean => {\r\n        if (!error.message || error.message.length <= 0) {\r\n            return false;\r\n        }\r\n\r\n        return (\r\n            error.message.indexOf('consent_required') > -1 ||\r\n            error.message.indexOf('interaction_required') > -1 ||\r\n            error.message.indexOf('login_required') > -1\r\n        );\r\n    }\r\n\r\n\r\n    return (\r\n        <>\r\n            {/* <Anchor>\r\n            <Button><Link href='/adduser' title=''/>  </Button> \r\n            </Anchor> */}\r\n            <Button href='/adduser' >Create New User</Button>\r\n            <br />\r\n            <Table dataSource={users} columns={columns} style={{ 'paddingTop': '10px' }} />\r\n\r\n            <Drawer\r\n                title=\"Create a new account\"\r\n                width={720}\r\n                onClose={onClose}\r\n                visible={drawerVisible}\r\n                bodyStyle={{ paddingBottom: 80 }}\r\n\r\n            >\r\n                <Form\r\n                    onFinish={userUpdateSave}\r\n                    initialValues={{\r\n                        'displayName': user === undefined ? '' : (user.displayName !== null ? user.displayName : ''),\r\n                        'givenName': user === undefined ? '' : (user.givenName !== null ? user.givenName : ''),\r\n                        'id': user === undefined ? '' : (user.id !== null ? user.id : ''),\r\n                        'jobTitle': user === undefined ? '' : (user.jobTitle !== null ? user.jobTitle : ''),\r\n                        'mobilePhone': user === undefined ? '' : (user.mobilePhone !== null ? user.mobilePhone : ''),\r\n                        'officeLocation': user === undefined ? '' : (user.officeLocation !== null ? user.officeLocation : ''),\r\n                        'surname': user === undefined ? '' : (user.surname !== null ? user.surname : ''),\r\n                        'userPrincipalName': user === undefined ? '' : (user.userPrincipalName !== null ? user.userPrincipalName : ''),\r\n                        'mail': user === undefined ? '' : (user.mail !== null ? user.mail : ''),\r\n                    }}\r\n                >\r\n\r\n\r\n                    <Form.Item\r\n                        label=\"Display Name\"\r\n                        name=\"displayName\"\r\n                    >\r\n                        <Input />\r\n                    </Form.Item>\r\n                    <Form.Item\r\n                        label=\"Email\"\r\n                        name=\"mail\"\r\n                    >\r\n                        <Input />\r\n                    </Form.Item>\r\n                    <br />\r\n                    <Form.Item>\r\n                        <Button type=\"primary\" htmlType=\"submit\">\r\n                            update\r\n                            </Button>\r\n                        <Button onClick={onClose} type=\"default\" htmlType=\"submit\">\r\n                            Cancel\r\n                            </Button>\r\n                    </Form.Item>\r\n                </Form>\r\n            </Drawer>\r\n\r\n        </>\r\n    );\r\n\r\n}\r\n\r\nexport default User;"]},"metadata":{},"sourceType":"module"}