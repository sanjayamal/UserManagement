{"ast":null,"code":"/*\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License.\n */\n\n/**\n * @hidden\n */\nvar CryptoUtils =\n/** @class */\nfunction () {\n  function CryptoUtils() {}\n  /**\n   * Creates a new random GUID - used to populate state?\n   * @returns string (GUID)\n   */\n\n\n  CryptoUtils.createNewGuid = function () {\n    /*\n     * RFC4122: The version 4 UUID is meant for generating UUIDs from truly-random or\n     * pseudo-random numbers.\n     * The algorithm is as follows:\n     *     Set the two most significant bits (bits 6 and 7) of the\n     *        clock_seq_hi_and_reserved to zero and one, respectively.\n     *     Set the four most significant bits (bits 12 through 15) of the\n     *        time_hi_and_version field to the 4-bit version number from\n     *        Section 4.1.3. Version4\n     *     Set all the other bits to randomly (or pseudo-randomly) chosen\n     *     values.\n     * UUID                   = time-low \"-\" time-mid \"-\"time-high-and-version \"-\"clock-seq-reserved and low(2hexOctet)\"-\" node\n     * time-low               = 4hexOctet\n     * time-mid               = 2hexOctet\n     * time-high-and-version  = 2hexOctet\n     * clock-seq-and-reserved = hexOctet:\n     * clock-seq-low          = hexOctet\n     * node                   = 6hexOctet\n     * Format: xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\n     * y could be 1000, 1001, 1010, 1011 since most significant two bits needs to be 10\n     * y values are 8, 9, A, B\n     */\n    var cryptoObj = window.crypto; // for IE 11\n\n    if (cryptoObj && cryptoObj.getRandomValues) {\n      var buffer = new Uint8Array(16);\n      cryptoObj.getRandomValues(buffer); // buffer[6] and buffer[7] represents the time_hi_and_version field. We will set the four most significant bits (4 through 7) of buffer[6] to represent decimal number 4 (UUID version number).\n\n      buffer[6] |= 0x40; // buffer[6] | 01000000 will set the 6 bit to 1.\n\n      buffer[6] &= 0x4f; // buffer[6] & 01001111 will set the 4, 5, and 7 bit to 0 such that bits 4-7 == 0100 = \"4\".\n      // buffer[8] represents the clock_seq_hi_and_reserved field. We will set the two most significant bits (6 and 7) of the clock_seq_hi_and_reserved to zero and one, respectively.\n\n      buffer[8] |= 0x80; // buffer[8] | 10000000 will set the 7 bit to 1.\n\n      buffer[8] &= 0xbf; // buffer[8] & 10111111 will set the 6 bit to 0.\n\n      return CryptoUtils.decimalToHex(buffer[0]) + CryptoUtils.decimalToHex(buffer[1]) + CryptoUtils.decimalToHex(buffer[2]) + CryptoUtils.decimalToHex(buffer[3]) + \"-\" + CryptoUtils.decimalToHex(buffer[4]) + CryptoUtils.decimalToHex(buffer[5]) + \"-\" + CryptoUtils.decimalToHex(buffer[6]) + CryptoUtils.decimalToHex(buffer[7]) + \"-\" + CryptoUtils.decimalToHex(buffer[8]) + CryptoUtils.decimalToHex(buffer[9]) + \"-\" + CryptoUtils.decimalToHex(buffer[10]) + CryptoUtils.decimalToHex(buffer[11]) + CryptoUtils.decimalToHex(buffer[12]) + CryptoUtils.decimalToHex(buffer[13]) + CryptoUtils.decimalToHex(buffer[14]) + CryptoUtils.decimalToHex(buffer[15]);\n    } else {\n      var guidHolder = \"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\";\n      var hex = \"0123456789abcdef\";\n      var r = 0;\n      var guidResponse = \"\";\n\n      for (var i = 0; i < 36; i++) {\n        if (guidHolder[i] !== \"-\" && guidHolder[i] !== \"4\") {\n          // each x and y needs to be random\n          r = Math.random() * 16 | 0;\n        }\n\n        if (guidHolder[i] === \"x\") {\n          guidResponse += hex[r];\n        } else if (guidHolder[i] === \"y\") {\n          // clock-seq-and-reserved first hex is filtered and remaining hex values are random\n          r &= 0x3; // bit and with 0011 to set pos 2 to zero ?0??\n\n          r |= 0x8; // set pos 3 to 1 as 1???\n\n          guidResponse += hex[r];\n        } else {\n          guidResponse += guidHolder[i];\n        }\n      }\n\n      return guidResponse;\n    }\n  };\n  /**\n   * verifies if a string is  GUID\n   * @param guid\n   */\n\n\n  CryptoUtils.isGuid = function (guid) {\n    var regexGuid = /^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i;\n    return regexGuid.test(guid);\n  };\n  /**\n   * Decimal to Hex\n   *\n   * @param num\n   */\n\n\n  CryptoUtils.decimalToHex = function (num) {\n    var hex = num.toString(16);\n\n    while (hex.length < 2) {\n      hex = \"0\" + hex;\n    }\n\n    return hex;\n  }; // See: https://developer.mozilla.org/en-US/docs/Web/API/WindowBase64/Base64_encoding_and_decoding#Solution_4_%E2%80%93_escaping_the_string_before_encoding_it\n\n  /**\n   * encoding string to base64 - platform specific check\n   *\n   * @param input\n   */\n\n\n  CryptoUtils.base64Encode = function (input) {\n    return btoa(encodeURIComponent(input).replace(/%([0-9A-F]{2})/g, function toSolidBytes(match, p1) {\n      return String.fromCharCode(Number(\"0x\" + p1));\n    }));\n  };\n  /**\n   * Decodes a base64 encoded string.\n   *\n   * @param input\n   */\n\n\n  CryptoUtils.base64Decode = function (input) {\n    var encodedString = input.replace(/-/g, \"+\").replace(/_/g, \"/\");\n\n    switch (encodedString.length % 4) {\n      case 0:\n        break;\n\n      case 2:\n        encodedString += \"==\";\n        break;\n\n      case 3:\n        encodedString += \"=\";\n        break;\n\n      default:\n        throw new Error(\"Invalid base64 string\");\n    }\n\n    return decodeURIComponent(atob(encodedString).split(\"\").map(function (c) {\n      return \"%\" + (\"00\" + c.charCodeAt(0).toString(16)).slice(-2);\n    }).join(\"\"));\n  };\n  /**\n   * deserialize a string\n   *\n   * @param query\n   */\n\n\n  CryptoUtils.deserialize = function (query) {\n    var match; // Regex for replacing addition symbol with a space\n\n    var pl = /\\+/g;\n    var search = /([^&=]+)=([^&]*)/g;\n\n    var decode = function (s) {\n      return decodeURIComponent(s.replace(pl, \" \"));\n    };\n\n    var obj = {};\n    match = search.exec(query);\n\n    while (match) {\n      obj[decode(match[1])] = decode(match[2]);\n      match = search.exec(query);\n    }\n\n    return obj;\n  };\n\n  return CryptoUtils;\n}();\n\nexport { CryptoUtils };","map":{"version":3,"sources":["../../src/utils/CryptoUtils.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["/*\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License.\n */\n/**\n * @hidden\n */\nvar CryptoUtils = /** @class */ (function () {\n    function CryptoUtils() {\n    }\n    /**\n     * Creates a new random GUID - used to populate state?\n     * @returns string (GUID)\n     */\n    CryptoUtils.createNewGuid = function () {\n        /*\n         * RFC4122: The version 4 UUID is meant for generating UUIDs from truly-random or\n         * pseudo-random numbers.\n         * The algorithm is as follows:\n         *     Set the two most significant bits (bits 6 and 7) of the\n         *        clock_seq_hi_and_reserved to zero and one, respectively.\n         *     Set the four most significant bits (bits 12 through 15) of the\n         *        time_hi_and_version field to the 4-bit version number from\n         *        Section 4.1.3. Version4\n         *     Set all the other bits to randomly (or pseudo-randomly) chosen\n         *     values.\n         * UUID                   = time-low \"-\" time-mid \"-\"time-high-and-version \"-\"clock-seq-reserved and low(2hexOctet)\"-\" node\n         * time-low               = 4hexOctet\n         * time-mid               = 2hexOctet\n         * time-high-and-version  = 2hexOctet\n         * clock-seq-and-reserved = hexOctet:\n         * clock-seq-low          = hexOctet\n         * node                   = 6hexOctet\n         * Format: xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\n         * y could be 1000, 1001, 1010, 1011 since most significant two bits needs to be 10\n         * y values are 8, 9, A, B\n         */\n        var cryptoObj = window.crypto; // for IE 11\n        if (cryptoObj && cryptoObj.getRandomValues) {\n            var buffer = new Uint8Array(16);\n            cryptoObj.getRandomValues(buffer);\n            // buffer[6] and buffer[7] represents the time_hi_and_version field. We will set the four most significant bits (4 through 7) of buffer[6] to represent decimal number 4 (UUID version number).\n            buffer[6] |= 0x40; // buffer[6] | 01000000 will set the 6 bit to 1.\n            buffer[6] &= 0x4f; // buffer[6] & 01001111 will set the 4, 5, and 7 bit to 0 such that bits 4-7 == 0100 = \"4\".\n            // buffer[8] represents the clock_seq_hi_and_reserved field. We will set the two most significant bits (6 and 7) of the clock_seq_hi_and_reserved to zero and one, respectively.\n            buffer[8] |= 0x80; // buffer[8] | 10000000 will set the 7 bit to 1.\n            buffer[8] &= 0xbf; // buffer[8] & 10111111 will set the 6 bit to 0.\n            return CryptoUtils.decimalToHex(buffer[0]) + CryptoUtils.decimalToHex(buffer[1])\n                + CryptoUtils.decimalToHex(buffer[2]) + CryptoUtils.decimalToHex(buffer[3])\n                + \"-\" + CryptoUtils.decimalToHex(buffer[4]) + CryptoUtils.decimalToHex(buffer[5])\n                + \"-\" + CryptoUtils.decimalToHex(buffer[6]) + CryptoUtils.decimalToHex(buffer[7])\n                + \"-\" + CryptoUtils.decimalToHex(buffer[8]) + CryptoUtils.decimalToHex(buffer[9])\n                + \"-\" + CryptoUtils.decimalToHex(buffer[10]) + CryptoUtils.decimalToHex(buffer[11])\n                + CryptoUtils.decimalToHex(buffer[12]) + CryptoUtils.decimalToHex(buffer[13])\n                + CryptoUtils.decimalToHex(buffer[14]) + CryptoUtils.decimalToHex(buffer[15]);\n        }\n        else {\n            var guidHolder = \"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\";\n            var hex = \"0123456789abcdef\";\n            var r = 0;\n            var guidResponse = \"\";\n            for (var i = 0; i < 36; i++) {\n                if (guidHolder[i] !== \"-\" && guidHolder[i] !== \"4\") {\n                    // each x and y needs to be random\n                    r = Math.random() * 16 | 0;\n                }\n                if (guidHolder[i] === \"x\") {\n                    guidResponse += hex[r];\n                }\n                else if (guidHolder[i] === \"y\") {\n                    // clock-seq-and-reserved first hex is filtered and remaining hex values are random\n                    r &= 0x3; // bit and with 0011 to set pos 2 to zero ?0??\n                    r |= 0x8; // set pos 3 to 1 as 1???\n                    guidResponse += hex[r];\n                }\n                else {\n                    guidResponse += guidHolder[i];\n                }\n            }\n            return guidResponse;\n        }\n    };\n    /**\n     * verifies if a string is  GUID\n     * @param guid\n     */\n    CryptoUtils.isGuid = function (guid) {\n        var regexGuid = /^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i;\n        return regexGuid.test(guid);\n    };\n    /**\n     * Decimal to Hex\n     *\n     * @param num\n     */\n    CryptoUtils.decimalToHex = function (num) {\n        var hex = num.toString(16);\n        while (hex.length < 2) {\n            hex = \"0\" + hex;\n        }\n        return hex;\n    };\n    // See: https://developer.mozilla.org/en-US/docs/Web/API/WindowBase64/Base64_encoding_and_decoding#Solution_4_%E2%80%93_escaping_the_string_before_encoding_it\n    /**\n     * encoding string to base64 - platform specific check\n     *\n     * @param input\n     */\n    CryptoUtils.base64Encode = function (input) {\n        return btoa(encodeURIComponent(input).replace(/%([0-9A-F]{2})/g, function toSolidBytes(match, p1) {\n            return String.fromCharCode(Number(\"0x\" + p1));\n        }));\n    };\n    /**\n     * Decodes a base64 encoded string.\n     *\n     * @param input\n     */\n    CryptoUtils.base64Decode = function (input) {\n        var encodedString = input.replace(/-/g, \"+\").replace(/_/g, \"/\");\n        switch (encodedString.length % 4) {\n            case 0:\n                break;\n            case 2:\n                encodedString += \"==\";\n                break;\n            case 3:\n                encodedString += \"=\";\n                break;\n            default:\n                throw new Error(\"Invalid base64 string\");\n        }\n        return decodeURIComponent(atob(encodedString).split(\"\").map(function (c) {\n            return \"%\" + (\"00\" + c.charCodeAt(0).toString(16)).slice(-2);\n        }).join(\"\"));\n    };\n    /**\n     * deserialize a string\n     *\n     * @param query\n     */\n    CryptoUtils.deserialize = function (query) {\n        var match; // Regex for replacing addition symbol with a space\n        var pl = /\\+/g;\n        var search = /([^&=]+)=([^&]*)/g;\n        var decode = function (s) { return decodeURIComponent(s.replace(pl, \" \")); };\n        var obj = {};\n        match = search.exec(query);\n        while (match) {\n            obj[decode(match[1])] = decode(match[2]);\n            match = search.exec(query);\n        }\n        return obj;\n    };\n    return CryptoUtils;\n}());\nexport { CryptoUtils };\n//# sourceMappingURL=CryptoUtils.js.map"]},"metadata":{},"sourceType":"module"}