{"ast":null,"code":"var graph = require('@microsoft/microsoft-graph-client');\n\nfunction getAuthenticatedClient(accessToken) {\n  // Initialize Graph client\n  const client = graph.Client.init({\n    // Use the provided access token to authenticate\n    // requests\n    authProvider: done => {\n      done(null, accessToken);\n    }\n  });\n  return client;\n}\n\nexport async function getEvents(accessToken) {\n  const client = getAuthenticatedClient(accessToken);\n  const events = await client.api('/me/events').select('subject,organizer,start,end').orderby('createdDateTime DESC').get();\n  return events;\n}\nexport async function getUserDetails(accessToken) {\n  const client = getAuthenticatedClient(accessToken);\n  const user = await client.api('/me').get();\n  return user;\n}\nexport async function createUser(accessToken, user) {\n  const client = getAuthenticatedClient(accessToken);\n  await client.api('/users').post(user).then(res => res); // return res;\n}\nexport async function getUser(accessToken) {\n  const client = getAuthenticatedClient(accessToken);\n  let res = await client.api('/users').get();\n  return res;\n}\nexport async function deleteUser(accessToken, id) {\n  const client = getAuthenticatedClient(accessToken);\n  let res = await client.api(`/users/${id}`).delete();\n  return res;\n}\nexport async function updateUser(accessToken, user) {\n  const {\n    id\n  } = user;\n  console.log(id);\n  const client = getAuthenticatedClient(accessToken);\n  let res = await client.api(`/users/${id}`).update(user).then(res => res);\n  return res;\n}","map":{"version":3,"sources":["D:/Assignment/graph-tutorial/UserManagement/src/GraphService.ts"],"names":["graph","require","getAuthenticatedClient","accessToken","client","Client","init","authProvider","done","getEvents","events","api","select","orderby","get","getUserDetails","user","createUser","post","then","res","getUser","deleteUser","id","delete","updateUser","console","log","update"],"mappings":"AAAA,IAAIA,KAAK,GAAGC,OAAO,CAAC,mCAAD,CAAnB;;AAEA,SAASC,sBAAT,CAAgCC,WAAhC,EAAqD;AACnD;AACA,QAAMC,MAAM,GAAGJ,KAAK,CAACK,MAAN,CAAaC,IAAb,CAAkB;AAC/B;AACA;AACAC,IAAAA,YAAY,EAAGC,IAAD,IAAe;AAC3BA,MAAAA,IAAI,CAAC,IAAD,EAAOL,WAAP,CAAJ;AACD;AAL8B,GAAlB,CAAf;AAQA,SAAOC,MAAP;AACD;;AAED,OAAO,eAAeK,SAAf,CAAyBN,WAAzB,EAA8C;AACjD,QAAMC,MAAM,GAAGF,sBAAsB,CAACC,WAAD,CAArC;AAEA,QAAMO,MAAM,GAAG,MAAMN,MAAM,CACxBO,GADkB,CACd,YADc,EAElBC,MAFkB,CAEX,6BAFW,EAGlBC,OAHkB,CAGV,sBAHU,EAIlBC,GAJkB,EAArB;AAMA,SAAOJ,MAAP;AACD;AAEH,OAAO,eAAeK,cAAf,CAA8BZ,WAA9B,EAAmD;AACxD,QAAMC,MAAM,GAAGF,sBAAsB,CAACC,WAAD,CAArC;AAEA,QAAMa,IAAI,GAAG,MAAMZ,MAAM,CAACO,GAAP,CAAW,KAAX,EAAkBG,GAAlB,EAAnB;AACA,SAAOE,IAAP;AACD;AAED,OAAO,eAAeC,UAAf,CAA0Bd,WAA1B,EAA6Ca,IAA7C,EAAsD;AAC3D,QAAMZ,MAAM,GAAGF,sBAAsB,CAACC,WAAD,CAArC;AACA,QAAMC,MAAM,CAACO,GAAP,CAAW,QAAX,EAAqBO,IAArB,CAA0BF,IAA1B,EACLG,IADK,CACCC,GAAD,IAAWA,GADX,CAAN,CAF2D,CAI5D;AACA;AAGD,OAAO,eAAeC,OAAf,CAAuBlB,WAAvB,EAA0C;AAC/C,QAAMC,MAAM,GAAGF,sBAAsB,CAACC,WAAD,CAArC;AACA,MAAIiB,GAAG,GAAG,MAAMhB,MAAM,CAACO,GAAP,CAAW,QAAX,EAAqBG,GAArB,EAAhB;AACA,SAAOM,GAAP;AACD;AAED,OAAO,eAAeE,UAAf,CAA0BnB,WAA1B,EAA6CoB,EAA7C,EAAoD;AACzD,QAAMnB,MAAM,GAAGF,sBAAsB,CAACC,WAAD,CAArC;AACA,MAAIiB,GAAG,GAAC,MAAMhB,MAAM,CAACO,GAAP,CAAY,UAASY,EAAG,EAAxB,EAA2BC,MAA3B,EAAd;AACA,SAAOJ,GAAP;AACD;AAED,OAAO,eAAeK,UAAf,CAA0BtB,WAA1B,EAA6Ca,IAA7C,EAAsD;AAC1D,QAAM;AAACO,IAAAA;AAAD,MAAKP,IAAX;AACAU,EAAAA,OAAO,CAACC,GAAR,CAAYJ,EAAZ;AACA,QAAMnB,MAAM,GAAGF,sBAAsB,CAACC,WAAD,CAArC;AACA,MAAIiB,GAAG,GAAE,MAAMhB,MAAM,CAACO,GAAP,CAAY,UAASY,EAAG,EAAxB,EAA2BK,MAA3B,CAAkCZ,IAAlC,EACDG,IADC,CACKC,GAAD,IAAaA,GADjB,CAAf;AAED,SAAOA,GAAP;AACD","sourcesContent":["var graph = require('@microsoft/microsoft-graph-client');\r\n\r\nfunction getAuthenticatedClient(accessToken: string) {\r\n  // Initialize Graph client\r\n  const client = graph.Client.init({\r\n    // Use the provided access token to authenticate\r\n    // requests\r\n    authProvider: (done: any) => {\r\n      done(null, accessToken);\r\n    }\r\n  });\r\n\r\n  return client;\r\n}\r\n\r\nexport async function getEvents(accessToken: string) {\r\n    const client = getAuthenticatedClient(accessToken);\r\n  \r\n    const events = await client\r\n      .api('/me/events')\r\n      .select('subject,organizer,start,end')\r\n      .orderby('createdDateTime DESC')\r\n      .get();\r\n  \r\n    return events;\r\n  }\r\n  \r\nexport async function getUserDetails(accessToken: string) {\r\n  const client = getAuthenticatedClient(accessToken);\r\n\r\n  const user = await client.api('/me').get();\r\n  return user;\r\n}\r\n\r\nexport async function createUser(accessToken:string,user:any){\r\n  const client = getAuthenticatedClient(accessToken);\r\n  await client.api('/users').post(user)\r\n  .then((res:any)=>res);\r\n // return res;\r\n}\r\n\r\n\r\nexport async function getUser(accessToken:string){\r\n  const client = getAuthenticatedClient(accessToken);\r\n  let res = await client.api('/users').get();\r\n  return res;\r\n}\r\n\r\nexport async function deleteUser(accessToken:string,id:any){\r\n  const client = getAuthenticatedClient(accessToken);\r\n  let res=await client.api(`/users/${id}`).delete()\r\n  return res;\r\n}\r\n\r\nexport async function updateUser(accessToken:string,user:any){\r\n   const {id}=user;\r\n   console.log(id)\r\n   const client = getAuthenticatedClient(accessToken);\r\n   let res= await client.api(`/users/${id}`).update(user)\r\n                .then((res:any) => res);\r\n  return res;\r\n}"]},"metadata":{},"sourceType":"module"}