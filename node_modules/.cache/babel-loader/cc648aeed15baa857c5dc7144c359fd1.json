{"ast":null,"code":"var _jsxFileName = \"D:\\\\Assignment\\\\graph-tutorial\\\\src\\\\Users.tsx\";\nimport React, { useState, useEffect } from 'react';\nimport { config } from './Config';\nimport { UserAgentApplication } from 'msal';\nimport { getUser } from './GraphService';\nimport 'antd/dist/antd.css';\n\nconst User = () => {\n  const [users, setUser] = useState([]);\n  useEffect(() => {\n    getUserService().then(result => {\n      console.log(result);\n    });\n  }, []);\n  const userAgentApplication = new UserAgentApplication({\n    auth: {\n      clientId: config.appId,\n      redirectUri: config.redirectUri\n    },\n    cache: {\n      cacheLocation: \"sessionStorage\",\n      storeAuthStateInCookie: true\n    }\n  });\n\n  const isInteractionRequired = error => {\n    if (!error.message || error.message.length <= 0) {\n      return false;\n    }\n\n    return error.message.indexOf('consent_required') > -1 || error.message.indexOf('interaction_required') > -1 || error.message.indexOf('login_required') > -1;\n  };\n\n  const getAccessToken = async scopes => {\n    try {\n      var silentResult = await userAgentApplication.acquireTokenSilent({\n        scopes: scopes\n      });\n      return silentResult.accessToken;\n    } catch (err) {\n      // If a silent request fails, it may be because the user needs\n      // to login or grant consent to one or more of the requested scopes\n      if (isInteractionRequired(err)) {\n        var interactiveResult = await userAgentApplication.acquireTokenPopup({\n          scopes: scopes\n        });\n        return interactiveResult.accessToken;\n      } else {\n        throw err;\n      }\n    }\n  };\n\n  const getUserService = async () => {\n    const accessToken = await getAccessToken(config.scopes);\n    getUser(accessToken).then(result => {\n      const {\n        value\n      } = result;\n      setUser(value);\n    });\n  };\n\n  return users.map(e => {\n    return /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 20\n      }\n    }, \" \", e.displayName, \" \");\n  });\n};\n\nexport default User;","map":{"version":3,"sources":["D:/Assignment/graph-tutorial/src/Users.tsx"],"names":["React","useState","useEffect","config","UserAgentApplication","getUser","User","users","setUser","getUserService","then","result","console","log","userAgentApplication","auth","clientId","appId","redirectUri","cache","cacheLocation","storeAuthStateInCookie","isInteractionRequired","error","message","length","indexOf","getAccessToken","scopes","silentResult","acquireTokenSilent","accessToken","err","interactiveResult","acquireTokenPopup","value","map","e","displayName"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,QAAhB,EAA0BC,SAA1B,QAA2C,OAA3C;AACA,SAASC,MAAT,QAAuB,UAAvB;AACA,SAASC,oBAAT,QAAqC,MAArC;AACA,SAASC,OAAT,QAAwB,gBAAxB;AAEA,OAAO,oBAAP;;AAEA,MAAMC,IAAI,GAAG,MAAM;AAEf,QAAM,CAACC,KAAD,EAAQC,OAAR,IAAmBP,QAAQ,CAAM,EAAN,CAAjC;AAMAC,EAAAA,SAAS,CAAC,MAAM;AACZO,IAAAA,cAAc,GAAGC,IAAjB,CAAsBC,MAAM,IAAI;AAC5BC,MAAAA,OAAO,CAACC,GAAR,CAAYF,MAAZ;AACH,KAFD;AAGH,GAJQ,EAIN,EAJM,CAAT;AAMA,QAAMG,oBAAoB,GAAG,IAAIV,oBAAJ,CAAyB;AAClDW,IAAAA,IAAI,EAAE;AACFC,MAAAA,QAAQ,EAAEb,MAAM,CAACc,KADf;AAEFC,MAAAA,WAAW,EAAEf,MAAM,CAACe;AAFlB,KAD4C;AAKlDC,IAAAA,KAAK,EAAE;AACHC,MAAAA,aAAa,EAAE,gBADZ;AAEHC,MAAAA,sBAAsB,EAAE;AAFrB;AAL2C,GAAzB,CAA7B;;AAWA,QAAMC,qBAAqB,GAAIC,KAAD,IAA2B;AACrD,QAAI,CAACA,KAAK,CAACC,OAAP,IAAkBD,KAAK,CAACC,OAAN,CAAcC,MAAd,IAAwB,CAA9C,EAAiD;AAC7C,aAAO,KAAP;AACH;;AAED,WACIF,KAAK,CAACC,OAAN,CAAcE,OAAd,CAAsB,kBAAtB,IAA4C,CAAC,CAA7C,IACAH,KAAK,CAACC,OAAN,CAAcE,OAAd,CAAsB,sBAAtB,IAAgD,CAAC,CADjD,IAEAH,KAAK,CAACC,OAAN,CAAcE,OAAd,CAAsB,gBAAtB,IAA0C,CAAC,CAH/C;AAKH,GAVD;;AAYA,QAAMC,cAAc,GAAG,MAAOC,MAAP,IAA4B;AAE/C,QAAI;AACA,UAAIC,YAAY,GAAG,MAAMf,oBAAoB,CAACgB,kBAArB,CAAwC;AAC7DF,QAAAA,MAAM,EAAEA;AADqD,OAAxC,CAAzB;AAGA,aAAOC,YAAY,CAACE,WAApB;AACH,KALD,CAKE,OAAOC,GAAP,EAAY;AACV;AACA;AACA,UAAIV,qBAAqB,CAACU,GAAD,CAAzB,EAAgC;AAC5B,YAAIC,iBAAiB,GAAG,MAAMnB,oBAAoB,CAACoB,iBAArB,CAAuC;AACjEN,UAAAA,MAAM,EAAEA;AADyD,SAAvC,CAA9B;AAIA,eAAOK,iBAAiB,CAACF,WAAzB;AACH,OAND,MAMO;AACH,cAAMC,GAAN;AACH;AACJ;AACJ,GApBD;;AAsBA,QAAMvB,cAAc,GAAG,YAAY;AAC/B,UAAMsB,WAAW,GAAG,MAAMJ,cAAc,CAACxB,MAAM,CAACyB,MAAR,CAAxC;AACAvB,IAAAA,OAAO,CAAC0B,WAAD,CAAP,CACKrB,IADL,CACWC,MAAD,IAAiB;AACnB,YAAM;AAAEwB,QAAAA;AAAF,UAAYxB,MAAlB;AACAH,MAAAA,OAAO,CAAC2B,KAAD,CAAP;AACH,KAJL;AAMH,GARD;;AAUA,SACI5B,KAAK,CAAC6B,GAAN,CAAWC,CAAD,IAAY;AAClB,wBAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YAAMA,CAAC,CAACC,WAAR,MAAP;AACH,GAFD,CADJ;AAOH,CA5ED;;AA8EA,eAAehC,IAAf","sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { config } from './Config';\r\nimport { UserAgentApplication } from 'msal';\r\nimport { getUser } from './GraphService';\r\nimport { Table, Tag, Space } from 'antd';\r\nimport 'antd/dist/antd.css';\r\n\r\nconst User = () => {\r\n\r\n    const [users, setUser] = useState<any>([]);\r\n\r\n\r\n    \r\n\r\n\r\n    useEffect(() => {\r\n        getUserService().then(result => {\r\n            console.log(result)\r\n        });\r\n    }, []);\r\n\r\n    const userAgentApplication = new UserAgentApplication({\r\n        auth: {\r\n            clientId: config.appId,\r\n            redirectUri: config.redirectUri\r\n        },\r\n        cache: {\r\n            cacheLocation: \"sessionStorage\",\r\n            storeAuthStateInCookie: true\r\n        }\r\n    });\r\n\r\n    const isInteractionRequired = (error: Error): boolean => {\r\n        if (!error.message || error.message.length <= 0) {\r\n            return false;\r\n        }\r\n\r\n        return (\r\n            error.message.indexOf('consent_required') > -1 ||\r\n            error.message.indexOf('interaction_required') > -1 ||\r\n            error.message.indexOf('login_required') > -1\r\n        );\r\n    }\r\n\r\n    const getAccessToken = async (scopes: string[]) => {\r\n\r\n        try {\r\n            var silentResult = await userAgentApplication.acquireTokenSilent({\r\n                scopes: scopes\r\n            });\r\n            return silentResult.accessToken;\r\n        } catch (err) {\r\n            // If a silent request fails, it may be because the user needs\r\n            // to login or grant consent to one or more of the requested scopes\r\n            if (isInteractionRequired(err)) {\r\n                var interactiveResult = await userAgentApplication.acquireTokenPopup({\r\n                    scopes: scopes\r\n                });\r\n\r\n                return interactiveResult.accessToken;\r\n            } else {\r\n                throw err;\r\n            }\r\n        }\r\n    }\r\n\r\n    const getUserService = async () => {\r\n        const accessToken = await getAccessToken(config.scopes);\r\n        getUser(accessToken)\r\n            .then((result: any) => {\r\n                const { value } = result;\r\n                setUser(value)\r\n            });\r\n\r\n    }\r\n\r\n    return (\r\n        users.map((e: any) => {\r\n            return <p> { e.displayName } </p>\r\n        })\r\n       \r\n    );\r\n\r\n}\r\n\r\nexport default User;"]},"metadata":{},"sourceType":"module"}