{"ast":null,"code":"var _jsxFileName = \"D:\\\\Assignment\\\\graph-tutorial\\\\UserManagement\\\\src\\\\Calendar.tsx\";\nimport React from 'react';\nimport { Table } from 'reactstrap';\nimport moment from 'moment';\nimport { config } from './Config';\nimport { getEvents } from './GraphService';\nimport withAuthProvider from './AuthProvider';\n\n// Helper function to format Graph date/time\nfunction formatDateTime(dateTime) {\n  if (dateTime !== undefined) {\n    return moment.utc(dateTime).local().format('M/D/YY h:mm A');\n  }\n}\n\nclass Calendar extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      events: []\n    };\n  }\n\n  async componentDidMount() {\n    try {\n      // Get the user's access token\n      var accessToken = await this.props.getAccessToken(config.scopes); // Get the user's events\n\n      var events = await getEvents(accessToken); // Update the array of events in state\n\n      this.setState({\n        events: events.value\n      });\n    } catch (err) {\n      this.props.setError('ERROR', JSON.stringify(err));\n    }\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 45,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"h1\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 46,\n        columnNumber: 17\n      }\n    }, \"Calendar\"), /*#__PURE__*/React.createElement(Table, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 47,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"thead\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 48,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"tr\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 49,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"th\", {\n      scope: \"col\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 50,\n        columnNumber: 29\n      }\n    }, \"Organizer\"), /*#__PURE__*/React.createElement(\"th\", {\n      scope: \"col\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 51,\n        columnNumber: 29\n      }\n    }, \"Subject\"), /*#__PURE__*/React.createElement(\"th\", {\n      scope: \"col\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 52,\n        columnNumber: 29\n      }\n    }, \"Start\"), /*#__PURE__*/React.createElement(\"th\", {\n      scope: \"col\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 53,\n        columnNumber: 29\n      }\n    }, \"End\"))), /*#__PURE__*/React.createElement(\"tbody\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 56,\n        columnNumber: 21\n      }\n    }, this.state.events.map(function (event) {\n      var _event$organizer, _event$organizer$emai, _event$start, _event$end;\n\n      return /*#__PURE__*/React.createElement(\"tr\", {\n        key: event.id,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 60,\n          columnNumber: 37\n        }\n      }, /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 61,\n          columnNumber: 41\n        }\n      }, (_event$organizer = event.organizer) === null || _event$organizer === void 0 ? void 0 : (_event$organizer$emai = _event$organizer.emailAddress) === null || _event$organizer$emai === void 0 ? void 0 : _event$organizer$emai.name), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 62,\n          columnNumber: 41\n        }\n      }, event.subject), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 63,\n          columnNumber: 41\n        }\n      }, formatDateTime((_event$start = event.start) === null || _event$start === void 0 ? void 0 : _event$start.dateTime)), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 64,\n          columnNumber: 41\n        }\n      }, formatDateTime((_event$end = event.end) === null || _event$end === void 0 ? void 0 : _event$end.dateTime)));\n    }))));\n  }\n\n}\n\nexport default withAuthProvider(Calendar);","map":{"version":3,"sources":["D:/Assignment/graph-tutorial/UserManagement/src/Calendar.tsx"],"names":["React","Table","moment","config","getEvents","withAuthProvider","formatDateTime","dateTime","undefined","utc","local","format","Calendar","Component","constructor","props","state","events","componentDidMount","accessToken","getAccessToken","scopes","setState","value","err","setError","JSON","stringify","render","map","event","id","organizer","emailAddress","name","subject","start","end"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport { Table } from 'reactstrap';\r\nimport moment from 'moment';\r\nimport { Event } from 'microsoft-graph';\r\nimport { config } from './Config';\r\nimport { getEvents } from './GraphService';\r\nimport withAuthProvider, { AuthComponentProps } from './AuthProvider';\r\n\r\ninterface CalendarState {\r\n    events: Event[];\r\n}\r\n\r\n// Helper function to format Graph date/time\r\nfunction formatDateTime(dateTime: string | undefined) {\r\n    if (dateTime !== undefined) {\r\n        return moment.utc(dateTime).local().format('M/D/YY h:mm A');\r\n    }\r\n}\r\n\r\nclass Calendar extends React.Component<AuthComponentProps, CalendarState> {\r\n    constructor(props: any) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            events: []\r\n        };\r\n    }\r\n\r\n    async componentDidMount() {\r\n        try {\r\n            // Get the user's access token\r\n            var accessToken = await this.props.getAccessToken(config.scopes);\r\n            // Get the user's events\r\n            var events = await getEvents(accessToken);\r\n            // Update the array of events in state\r\n            this.setState({ events: events.value });\r\n        }\r\n        catch (err) {\r\n            this.props.setError('ERROR', JSON.stringify(err));\r\n        }\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div>\r\n                <h1>Calendar</h1>\r\n                <Table>\r\n                    <thead>\r\n                        <tr>\r\n                            <th scope=\"col\">Organizer</th>\r\n                            <th scope=\"col\">Subject</th>\r\n                            <th scope=\"col\">Start</th>\r\n                            <th scope=\"col\">End</th>\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                        {this.state.events.map(\r\n                            function (event: Event) {\r\n                                return (\r\n                                    <tr key={event.id}>\r\n                                        <td>{event.organizer?.emailAddress?.name}</td>\r\n                                        <td>{event.subject}</td>\r\n                                        <td>{formatDateTime(event.start?.dateTime)}</td>\r\n                                        <td>{formatDateTime(event.end?.dateTime)}</td>\r\n                                    </tr>\r\n                                );\r\n                            })}\r\n                    </tbody>\r\n                </Table>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default withAuthProvider(Calendar);"]},"metadata":{},"sourceType":"module"}