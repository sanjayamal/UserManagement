{"ast":null,"code":"var _jsxFileName = \"D:\\\\Assignment\\\\graph-tutorial\\\\src\\\\User.tsx\";\nimport React from 'react';\nimport { Form, Input, Button, Switch } from 'antd';\nimport 'antd/dist/antd.css';\nimport { Row, Col } from 'antd';\nimport { createUser } from './GraphService';\nimport { config } from './Config';\nimport { UserAgentApplication } from 'msal';\n\nconst User = () => {\n  const userAgentApplication = new UserAgentApplication({\n    auth: {\n      clientId: config.appId,\n      redirectUri: config.redirectUri\n    },\n    cache: {\n      cacheLocation: \"sessionStorage\",\n      storeAuthStateInCookie: true\n    }\n  });\n\n  const getAccessToken = async scopes => {\n    var silentResult = await userAgentApplication.acquireTokenSilent({\n      scopes: scopes\n    });\n    return silentResult.accessToken;\n  };\n\n  const passwordProfile = {\n    \"forceChangePasswordNextSignIn\": true,\n    \"forceChangePasswordNextSignInWithMfa\": false,\n    \"password\": \"string\"\n  };\n\n  const getMailNickName = email => {\n    let nickName = email.split('@');\n    return nickName;\n  };\n\n  const onFinish = async values => {\n    var accessToken = await getAccessToken(config.scopes);\n    const {\n      userPrincipalName\n    } = values;\n    let mailNickname = getMailNickName(userPrincipalName)[0];\n    const requestBody = { ...values,\n      mailNickname,\n      passwordProfile: { ...passwordProfile\n      }\n    };\n    console.log('access');\n    const res = createUser(accessToken, requestBody);\n    console.log(requestBody);\n    console.log(res);\n  };\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 55,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Col, {\n    span: 6,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 17\n    }\n  }), /*#__PURE__*/React.createElement(Col, {\n    span: 12,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(Form, {\n    onFinish: onFinish,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(Form.Item, {\n    label: \"Account Enable\",\n    name: \"accountEnabled\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(Switch, {\n    checkedChildren: \"Yes\",\n    unCheckedChildren: \"No\",\n    defaultChecked: false,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 29\n    }\n  })), /*#__PURE__*/React.createElement(Form.Item, {\n    label: \"Display Name\",\n    name: \"displayName\",\n    rules: [{\n      required: true,\n      message: 'Please input your Display Name!'\n    }],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(Input, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 29\n    }\n  })), /*#__PURE__*/React.createElement(Form.Item, {\n    label: \"Email\",\n    name: \"userPrincipalName\",\n    rules: [{\n      message: 'Please input your Email'\n    }],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(Input, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 29\n    }\n  })), /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 25\n    }\n  }), /*#__PURE__*/React.createElement(Form.Item, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    type: \"primary\",\n    htmlType: \"submit\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 29\n    }\n  }, \"Create\")))), /*#__PURE__*/React.createElement(Col, {\n    span: 6,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 17\n    }\n  })));\n};\n\nexport default User;","map":{"version":3,"sources":["D:/Assignment/graph-tutorial/src/User.tsx"],"names":["React","Form","Input","Button","Switch","Row","Col","createUser","config","UserAgentApplication","User","userAgentApplication","auth","clientId","appId","redirectUri","cache","cacheLocation","storeAuthStateInCookie","getAccessToken","scopes","silentResult","acquireTokenSilent","accessToken","passwordProfile","getMailNickName","email","nickName","split","onFinish","values","userPrincipalName","mailNickname","requestBody","console","log","res","required","message"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport { Form, Input, Button, Switch } from 'antd';\r\nimport 'antd/dist/antd.css';\r\nimport { Row, Col } from 'antd';\r\nimport { createUser } from './GraphService';\r\nimport { config } from './Config';\r\nimport { UserAgentApplication } from 'msal';\r\n\r\n\r\nconst User = () => {\r\n\r\n    const userAgentApplication = new UserAgentApplication({\r\n        auth: {\r\n            clientId: config.appId,\r\n            redirectUri: config.redirectUri\r\n        },\r\n        cache: {\r\n            cacheLocation: \"sessionStorage\",\r\n            storeAuthStateInCookie: true\r\n        }\r\n    });\r\n\r\n    const getAccessToken = async (scopes: string[]) => {\r\n        var silentResult = await userAgentApplication.acquireTokenSilent({\r\n            scopes: scopes\r\n        });\r\n        return silentResult.accessToken;\r\n    }\r\n    const passwordProfile = {\r\n        \"forceChangePasswordNextSignIn\": true,\r\n        \"forceChangePasswordNextSignInWithMfa\": false,\r\n        \"password\": \"string\"\r\n    }\r\n\r\n    const getMailNickName = (email: string) => {\r\n        let nickName = email.split('@');\r\n        return nickName;\r\n    }\r\n\r\n    const onFinish = async (values: any) => {\r\n\r\n        var accessToken = await getAccessToken(config.scopes);\r\n        const { userPrincipalName } = values;\r\n        let mailNickname = getMailNickName(userPrincipalName)[0]\r\n        const requestBody = { ...values, mailNickname, passwordProfile: { ...passwordProfile } }\r\n\r\n        console.log('access');\r\n        const res = createUser(accessToken, requestBody)\r\n        console.log(requestBody);\r\n        console.log(res);\r\n    };\r\n\r\n    return (\r\n        <>\r\n            <Row>\r\n                <Col span={6}></Col>\r\n                <Col span={12}>\r\n                    <Form\r\n                        onFinish={onFinish}\r\n                    >\r\n                        <Form.Item\r\n                            label='Account Enable'\r\n                            name='accountEnabled'>\r\n                            <Switch\r\n                                checkedChildren=\"Yes\" unCheckedChildren=\"No\" defaultChecked={false} />\r\n                        </Form.Item>\r\n\r\n                        <Form.Item\r\n                            label=\"Display Name\"\r\n                            name=\"displayName\"\r\n                            rules={[{ required: true, message: 'Please input your Display Name!' }]}\r\n                        >\r\n                            <Input />\r\n                        </Form.Item>\r\n                        <Form.Item\r\n                            label=\"Email\"\r\n                            name=\"userPrincipalName\"\r\n                            rules={[{ message: 'Please input your Email' }]}\r\n                        >\r\n                            <Input />\r\n                        </Form.Item>\r\n                        <br />\r\n                        <Form.Item>\r\n                            <Button type=\"primary\" htmlType=\"submit\">\r\n                                Create\r\n                            </Button>\r\n                        </Form.Item>\r\n                    </Form>\r\n                </Col>\r\n                <Col span={6}></Col>\r\n            </Row>\r\n\r\n        </>\r\n    );\r\n};\r\n\r\nexport default User;"]},"metadata":{},"sourceType":"module"}