{"ast":null,"code":"var _jsxFileName = \"D:\\\\Assignment\\\\graph-tutorial\\\\src\\\\Users.tsx\";\nimport React, { useState, useEffect } from 'react';\nimport { config } from './Config';\nimport { UserAgentApplication } from 'msal';\nimport { getUser } from './GraphService';\nimport { Table, Button, Anchor, Drawer, Form, Input } from 'antd';\nimport 'antd/dist/antd.css';\n\nconst User = () => {\n  const [users, setUser] = useState([]);\n  const {\n    Link\n  } = Anchor;\n  const [drawerVisible, setDrawerVisible] = useState(false);\n  useEffect(() => {\n    getUserService().then(result => {\n      console.log(result);\n    });\n  }, []);\n  const columns = [{\n    title: 'Display Name',\n    dataIndex: 'displayName',\n    key: 'displayName'\n  }, {\n    title: 'Mail',\n    dataIndex: 'mail',\n    key: 'mail'\n  }, {\n    title: '',\n    dataIndex: 'id',\n    key: 'id',\n    render: () => /*#__PURE__*/React.createElement(React.Fragment, null, \" \", /*#__PURE__*/React.createElement(Button, {\n      onClick: userUpdate,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 38,\n        columnNumber: 30\n      }\n    }, \"Update\"), /*#__PURE__*/React.createElement(Button, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 39,\n        columnNumber: 17\n      }\n    }, \"Delete\"))\n  } // {\n  //     title: 'Action',\n  //     dataIndex: '',\n  //     key: 'x',\n  //     render: () => <a>Delete</a>\n  // },\n  ];\n  const userAgentApplication = new UserAgentApplication({\n    auth: {\n      clientId: config.appId,\n      redirectUri: config.redirectUri\n    },\n    cache: {\n      cacheLocation: \"sessionStorage\",\n      storeAuthStateInCookie: true\n    }\n  });\n\n  const isInteractionRequired = error => {\n    if (!error.message || error.message.length <= 0) {\n      return false;\n    }\n\n    return error.message.indexOf('consent_required') > -1 || error.message.indexOf('interaction_required') > -1 || error.message.indexOf('login_required') > -1;\n  };\n\n  const getAccessToken = async scopes => {\n    try {\n      var silentResult = await userAgentApplication.acquireTokenSilent({\n        scopes: scopes\n      });\n      return silentResult.accessToken;\n    } catch (err) {\n      // If a silent request fails, it may be because the user needs\n      // to login or grant consent to one or more of the requested scopes\n      if (isInteractionRequired(err)) {\n        var interactiveResult = await userAgentApplication.acquireTokenPopup({\n          scopes: scopes\n        });\n        return interactiveResult.accessToken;\n      } else {\n        throw err;\n      }\n    }\n  };\n\n  const getUserService = async () => {\n    const accessToken = await getAccessToken(config.scopes);\n    getUser(accessToken).then(result => {\n      const {\n        value\n      } = result;\n      setUser(value);\n      console.log(value);\n    });\n  };\n\n  const userDelete = (values, e) => {\n    console.log(values);\n  };\n\n  const userUpdate = () => {\n    setDrawerVisible(true);\n  };\n\n  const onClose = () => {\n    setDrawerVisible(false);\n  };\n\n  const userUpdateSave = () => {};\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Button, {\n    href: \"/adduser\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 13\n    }\n  }, \"Craete New User\"), /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(Table, {\n    dataSource: users,\n    columns: columns,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(Drawer, {\n    title: \"Create a new account\",\n    width: 720,\n    onClose: onClose,\n    visible: drawerVisible,\n    bodyStyle: {\n      paddingBottom: 80\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Form, {\n    onFinish: onFinish,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 18\n    }\n  }, /*#__PURE__*/React.createElement(Form.Item, {\n    label: \"Account Enable\",\n    name: \"accountEnabled\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(Switch, {\n    checkedChildren: \"Yes\",\n    unCheckedChildren: \"No\",\n    defaultChecked: false,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 29\n    }\n  })), /*#__PURE__*/React.createElement(Form.Item, {\n    label: \"Display Name\",\n    name: \"displayName\",\n    rules: [{\n      required: true,\n      message: 'Please input your Display Name!'\n    }],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(Input, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 29\n    }\n  })), /*#__PURE__*/React.createElement(Form.Item, {\n    label: \"Email\",\n    name: \"userPrincipalName\",\n    rules: [{\n      message: 'Please input your Email'\n    }],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 158,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(Input, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 163,\n      columnNumber: 29\n    }\n  })), /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 165,\n      columnNumber: 25\n    }\n  }), /*#__PURE__*/React.createElement(Form.Item, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 166,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    type: \"primary\",\n    htmlType: \"submit\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 167,\n      columnNumber: 29\n    }\n  }, \"Create\")))));\n};\n\nexport default User;","map":{"version":3,"sources":["D:/Assignment/graph-tutorial/src/Users.tsx"],"names":["React","useState","useEffect","config","UserAgentApplication","getUser","Table","Button","Anchor","Drawer","Form","Input","User","users","setUser","Link","drawerVisible","setDrawerVisible","getUserService","then","result","console","log","columns","title","dataIndex","key","render","userUpdate","userAgentApplication","auth","clientId","appId","redirectUri","cache","cacheLocation","storeAuthStateInCookie","isInteractionRequired","error","message","length","indexOf","getAccessToken","scopes","silentResult","acquireTokenSilent","accessToken","err","interactiveResult","acquireTokenPopup","value","userDelete","values","e","onClose","userUpdateSave","paddingBottom","onFinish","required"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,QAAhB,EAA0BC,SAA1B,QAA2C,OAA3C;AACA,SAASC,MAAT,QAAuB,UAAvB;AACA,SAASC,oBAAT,QAAqC,MAArC;AACA,SAASC,OAAT,QAAwB,gBAAxB;AACA,SAASC,KAAT,EAAgBC,MAAhB,EAAwBC,MAAxB,EAAgCC,MAAhC,EAAuCC,IAAvC,EAA4CC,KAA5C,QAAyD,MAAzD;AACA,OAAO,oBAAP;;AAGA,MAAMC,IAAI,GAAG,MAAM;AAEf,QAAM,CAACC,KAAD,EAAQC,OAAR,IAAmBb,QAAQ,CAAM,EAAN,CAAjC;AACA,QAAM;AAAEc,IAAAA;AAAF,MAAWP,MAAjB;AACA,QAAM,CAACQ,aAAD,EAAgBC,gBAAhB,IAAoChB,QAAQ,CAAU,KAAV,CAAlD;AAIAC,EAAAA,SAAS,CAAC,MAAM;AACZgB,IAAAA,cAAc,GAAGC,IAAjB,CAAsBC,MAAM,IAAI;AAC5BC,MAAAA,OAAO,CAACC,GAAR,CAAYF,MAAZ;AACH,KAFD;AAGH,GAJQ,EAIN,EAJM,CAAT;AAMA,QAAMG,OAAO,GAAG,CACZ;AACIC,IAAAA,KAAK,EAAE,cADX;AAEIC,IAAAA,SAAS,EAAE,aAFf;AAGIC,IAAAA,GAAG,EAAE;AAHT,GADY,EAMZ;AACIF,IAAAA,KAAK,EAAE,MADX;AAEIC,IAAAA,SAAS,EAAE,MAFf;AAGIC,IAAAA,GAAG,EAAE;AAHT,GANY,EAWZ;AACIF,IAAAA,KAAK,EAAE,EADX;AAEIC,IAAAA,SAAS,EAAE,IAFf;AAGIC,IAAAA,GAAG,EAAE,IAHT;AAIIC,IAAAA,MAAM,EAAE,mBAAM,4DAAG,oBAAC,MAAD;AAAQ,MAAA,OAAO,EAAEC,UAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAAH,eACV,oBAAC,MAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBADU;AAJlB,GAXY,CAmBZ;AACA;AACA;AACA;AACA;AACA;AAxBY,GAAhB;AA2BA,QAAMC,oBAAoB,GAAG,IAAIzB,oBAAJ,CAAyB;AAClD0B,IAAAA,IAAI,EAAE;AACFC,MAAAA,QAAQ,EAAE5B,MAAM,CAAC6B,KADf;AAEFC,MAAAA,WAAW,EAAE9B,MAAM,CAAC8B;AAFlB,KAD4C;AAKlDC,IAAAA,KAAK,EAAE;AACHC,MAAAA,aAAa,EAAE,gBADZ;AAEHC,MAAAA,sBAAsB,EAAE;AAFrB;AAL2C,GAAzB,CAA7B;;AAWA,QAAMC,qBAAqB,GAAIC,KAAD,IAA2B;AACrD,QAAI,CAACA,KAAK,CAACC,OAAP,IAAkBD,KAAK,CAACC,OAAN,CAAcC,MAAd,IAAwB,CAA9C,EAAiD;AAC7C,aAAO,KAAP;AACH;;AAED,WACIF,KAAK,CAACC,OAAN,CAAcE,OAAd,CAAsB,kBAAtB,IAA4C,CAAC,CAA7C,IACAH,KAAK,CAACC,OAAN,CAAcE,OAAd,CAAsB,sBAAtB,IAAgD,CAAC,CADjD,IAEAH,KAAK,CAACC,OAAN,CAAcE,OAAd,CAAsB,gBAAtB,IAA0C,CAAC,CAH/C;AAKH,GAVD;;AAYA,QAAMC,cAAc,GAAG,MAAOC,MAAP,IAA4B;AAE/C,QAAI;AACA,UAAIC,YAAY,GAAG,MAAMf,oBAAoB,CAACgB,kBAArB,CAAwC;AAC7DF,QAAAA,MAAM,EAAEA;AADqD,OAAxC,CAAzB;AAGA,aAAOC,YAAY,CAACE,WAApB;AACH,KALD,CAKE,OAAOC,GAAP,EAAY;AACV;AACA;AACA,UAAIV,qBAAqB,CAACU,GAAD,CAAzB,EAAgC;AAC5B,YAAIC,iBAAiB,GAAG,MAAMnB,oBAAoB,CAACoB,iBAArB,CAAuC;AACjEN,UAAAA,MAAM,EAAEA;AADyD,SAAvC,CAA9B;AAIA,eAAOK,iBAAiB,CAACF,WAAzB;AACH,OAND,MAMO;AACH,cAAMC,GAAN;AACH;AACJ;AACJ,GApBD;;AAsBA,QAAM7B,cAAc,GAAG,YAAY;AAC/B,UAAM4B,WAAW,GAAG,MAAMJ,cAAc,CAACvC,MAAM,CAACwC,MAAR,CAAxC;AACAtC,IAAAA,OAAO,CAACyC,WAAD,CAAP,CACK3B,IADL,CACWC,MAAD,IAAiB;AACnB,YAAM;AAAE8B,QAAAA;AAAF,UAAY9B,MAAlB;AACAN,MAAAA,OAAO,CAACoC,KAAD,CAAP;AACA7B,MAAAA,OAAO,CAACC,GAAR,CAAY4B,KAAZ;AACH,KALL;AAOH,GATD;;AAWA,QAAMC,UAAU,GAAG,CAACC,MAAD,EAAcC,CAAd,KAAyB;AAExChC,IAAAA,OAAO,CAACC,GAAR,CAAY8B,MAAZ;AACH,GAHD;;AAKA,QAAMxB,UAAU,GAAG,MAAM;AACrBX,IAAAA,gBAAgB,CAAC,IAAD,CAAhB;AAEH,GAHD;;AAKA,QAAMqC,OAAO,GAAG,MAAM;AAClBrC,IAAAA,gBAAgB,CAAC,KAAD,CAAhB;AACH,GAFD;;AAIA,QAAMsC,cAAc,GAAG,MAAM,CAE5B,CAFD;;AAIA,sBACI,uDAII,oBAAC,MAAD;AAAQ,IAAA,IAAI,EAAC,UAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBAJJ,eAKI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IALJ,eAMI,oBAAC,KAAD;AAAO,IAAA,UAAU,EAAE1C,KAAnB;AAA0B,IAAA,OAAO,EAAEU,OAAnC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IANJ,eAQI,oBAAC,MAAD;AACI,IAAA,KAAK,EAAC,sBADV;AAEI,IAAA,KAAK,EAAE,GAFX;AAGI,IAAA,OAAO,EAAE+B,OAHb;AAII,IAAA,OAAO,EAAEtC,aAJb;AAKI,IAAA,SAAS,EAAE;AAAEwC,MAAAA,aAAa,EAAE;AAAjB,KALf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAQK,oBAAC,IAAD;AACO,IAAA,QAAQ,EAAEC,QADjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAGO,oBAAC,IAAD,CAAM,IAAN;AACI,IAAA,KAAK,EAAC,gBADV;AAEI,IAAA,IAAI,EAAC,gBAFT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAGI,oBAAC,MAAD;AACI,IAAA,eAAe,EAAC,KADpB;AAC0B,IAAA,iBAAiB,EAAC,IAD5C;AACiD,IAAA,cAAc,EAAE,KADjE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAHJ,CAHP,eAUO,oBAAC,IAAD,CAAM,IAAN;AACI,IAAA,KAAK,EAAC,cADV;AAEI,IAAA,IAAI,EAAC,aAFT;AAGI,IAAA,KAAK,EAAE,CAAC;AAAEC,MAAAA,QAAQ,EAAE,IAAZ;AAAkBnB,MAAAA,OAAO,EAAE;AAA3B,KAAD,CAHX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAKI,oBAAC,KAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IALJ,CAVP,eAiBO,oBAAC,IAAD,CAAM,IAAN;AACI,IAAA,KAAK,EAAC,OADV;AAEI,IAAA,IAAI,EAAC,mBAFT;AAGI,IAAA,KAAK,EAAE,CAAC;AAAEA,MAAAA,OAAO,EAAE;AAAX,KAAD,CAHX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAKI,oBAAC,KAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IALJ,CAjBP,eAwBO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAxBP,eAyBO,oBAAC,IAAD,CAAM,IAAN;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACI,oBAAC,MAAD;AAAQ,IAAA,IAAI,EAAC,SAAb;AAAuB,IAAA,QAAQ,EAAC,QAAhC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cADJ,CAzBP,CARL,CARJ,CADJ;AAqDH,CAxKD;;AA0KA,eAAe3B,IAAf","sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { config } from './Config';\r\nimport { UserAgentApplication } from 'msal';\r\nimport { getUser } from './GraphService';\r\nimport { Table, Button, Anchor, Drawer,Form,Input } from 'antd';\r\nimport 'antd/dist/antd.css';\r\n\r\n\r\nconst User = () => {\r\n\r\n    const [users, setUser] = useState<any>([]);\r\n    const { Link } = Anchor;\r\n    const [drawerVisible, setDrawerVisible] = useState<boolean>(false)\r\n\r\n\r\n\r\n    useEffect(() => {\r\n        getUserService().then(result => {\r\n            console.log(result)\r\n        });\r\n    }, []);\r\n\r\n    const columns = [\r\n        {\r\n            title: 'Display Name',\r\n            dataIndex: 'displayName',\r\n            key: 'displayName',\r\n        },\r\n        {\r\n            title: 'Mail',\r\n            dataIndex: 'mail',\r\n            key: 'mail',\r\n        },\r\n        {\r\n            title: '',\r\n            dataIndex: 'id',\r\n            key: 'id',\r\n            render: () => <> <Button onClick={userUpdate}>Update</Button>\r\n                <Button >Delete</Button>\r\n            </>,\r\n        },\r\n        // {\r\n        //     title: 'Action',\r\n        //     dataIndex: '',\r\n        //     key: 'x',\r\n        //     render: () => <a>Delete</a>\r\n        // },\r\n    ];\r\n\r\n    const userAgentApplication = new UserAgentApplication({\r\n        auth: {\r\n            clientId: config.appId,\r\n            redirectUri: config.redirectUri\r\n        },\r\n        cache: {\r\n            cacheLocation: \"sessionStorage\",\r\n            storeAuthStateInCookie: true\r\n        }\r\n    });\r\n\r\n    const isInteractionRequired = (error: Error): boolean => {\r\n        if (!error.message || error.message.length <= 0) {\r\n            return false;\r\n        }\r\n\r\n        return (\r\n            error.message.indexOf('consent_required') > -1 ||\r\n            error.message.indexOf('interaction_required') > -1 ||\r\n            error.message.indexOf('login_required') > -1\r\n        );\r\n    }\r\n\r\n    const getAccessToken = async (scopes: string[]) => {\r\n\r\n        try {\r\n            var silentResult = await userAgentApplication.acquireTokenSilent({\r\n                scopes: scopes\r\n            });\r\n            return silentResult.accessToken;\r\n        } catch (err) {\r\n            // If a silent request fails, it may be because the user needs\r\n            // to login or grant consent to one or more of the requested scopes\r\n            if (isInteractionRequired(err)) {\r\n                var interactiveResult = await userAgentApplication.acquireTokenPopup({\r\n                    scopes: scopes\r\n                });\r\n\r\n                return interactiveResult.accessToken;\r\n            } else {\r\n                throw err;\r\n            }\r\n        }\r\n    }\r\n\r\n    const getUserService = async () => {\r\n        const accessToken = await getAccessToken(config.scopes);\r\n        getUser(accessToken)\r\n            .then((result: any) => {\r\n                const { value } = result;\r\n                setUser(value)\r\n                console.log(value)\r\n            });\r\n\r\n    }\r\n\r\n    const userDelete = (values: any, e: any) => {\r\n\r\n        console.log(values)\r\n    }\r\n\r\n    const userUpdate = () => {\r\n        setDrawerVisible(true);\r\n\r\n    }\r\n\r\n    const onClose = () => {\r\n        setDrawerVisible(false)\r\n    }\r\n\r\n    const userUpdateSave = () => {\r\n\r\n    }\r\n\r\n    return (\r\n        <>\r\n            {/* <Anchor>\r\n            <Button><Link href='/adduser' title=''/>  </Button> \r\n            </Anchor> */}\r\n            <Button href='/adduser'>Craete New User</Button>\r\n            <br />\r\n            <Table dataSource={users} columns={columns} />\r\n\r\n            <Drawer\r\n                title=\"Create a new account\"\r\n                width={720}\r\n                onClose={onClose}\r\n                visible={drawerVisible}\r\n                bodyStyle={{ paddingBottom: 80 }}\r\n \r\n            >\r\n                 <Form\r\n                        onFinish={onFinish}\r\n                    >\r\n                        <Form.Item\r\n                            label='Account Enable'\r\n                            name='accountEnabled'>\r\n                            <Switch\r\n                                checkedChildren=\"Yes\" unCheckedChildren=\"No\" defaultChecked={false} />\r\n                        </Form.Item>\r\n\r\n                        <Form.Item\r\n                            label=\"Display Name\"\r\n                            name=\"displayName\"\r\n                            rules={[{ required: true, message: 'Please input your Display Name!' }]}\r\n                        >\r\n                            <Input />\r\n                        </Form.Item>\r\n                        <Form.Item\r\n                            label=\"Email\"\r\n                            name=\"userPrincipalName\"\r\n                            rules={[{ message: 'Please input your Email' }]}\r\n                        >\r\n                            <Input />\r\n                        </Form.Item>\r\n                        <br />\r\n                        <Form.Item>\r\n                            <Button type=\"primary\" htmlType=\"submit\">\r\n                                Create\r\n                            </Button>\r\n                        </Form.Item>\r\n                    </Form>\r\n            </Drawer>\r\n\r\n        </>\r\n    );\r\n\r\n}\r\n\r\nexport default User;"]},"metadata":{},"sourceType":"module"}