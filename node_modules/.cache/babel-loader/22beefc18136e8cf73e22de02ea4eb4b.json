{"ast":null,"code":"/*\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License.\n */\nimport { Constants, SSOTypes, ServerHashParamKeys } from \"./Constants\";\nimport { ScopeSet } from \"../ScopeSet\";\nimport { StringUtils } from \"./StringUtils\";\nimport { CryptoUtils } from \"./CryptoUtils\";\n/**\n * @hidden\n */\n\nvar UrlUtils =\n/** @class */\nfunction () {\n  function UrlUtils() {}\n  /**\n   * generates the URL with QueryString Parameters\n   * @param scopes\n   */\n\n\n  UrlUtils.createNavigateUrl = function (serverRequestParams) {\n    var str = this.createNavigationUrlString(serverRequestParams);\n    var authEndpoint = serverRequestParams.authorityInstance.AuthorizationEndpoint; // if the endpoint already has queryparams, lets add to it, otherwise add the first one\n\n    if (authEndpoint.indexOf(\"?\") < 0) {\n      authEndpoint += \"?\";\n    } else {\n      authEndpoint += \"&\";\n    }\n\n    var requestUrl = \"\" + authEndpoint + str.join(\"&\");\n    return requestUrl;\n  };\n  /**\n   * Generate the array of all QueryStringParams to be sent to the server\n   * @param scopes\n   */\n\n\n  UrlUtils.createNavigationUrlString = function (serverRequestParams) {\n    var scopes = serverRequestParams.scopes;\n\n    if (scopes.indexOf(serverRequestParams.clientId) === -1) {\n      scopes.push(serverRequestParams.clientId);\n    }\n\n    var str = [];\n    str.push(\"response_type=\" + serverRequestParams.responseType);\n    this.translateclientIdUsedInScope(scopes, serverRequestParams.clientId);\n    str.push(\"scope=\" + encodeURIComponent(ScopeSet.parseScope(scopes)));\n    str.push(\"client_id=\" + encodeURIComponent(serverRequestParams.clientId));\n    str.push(\"redirect_uri=\" + encodeURIComponent(serverRequestParams.redirectUri));\n    str.push(\"state=\" + encodeURIComponent(serverRequestParams.state));\n    str.push(\"nonce=\" + encodeURIComponent(serverRequestParams.nonce));\n    str.push(\"client_info=1\");\n    str.push(\"x-client-SKU=\" + serverRequestParams.xClientSku);\n    str.push(\"x-client-Ver=\" + serverRequestParams.xClientVer);\n\n    if (serverRequestParams.promptValue) {\n      str.push(\"prompt=\" + encodeURIComponent(serverRequestParams.promptValue));\n    }\n\n    if (serverRequestParams.claimsValue) {\n      str.push(\"claims=\" + encodeURIComponent(serverRequestParams.claimsValue));\n    }\n\n    if (serverRequestParams.queryParameters) {\n      str.push(serverRequestParams.queryParameters);\n    }\n\n    if (serverRequestParams.extraQueryParameters) {\n      str.push(serverRequestParams.extraQueryParameters);\n    }\n\n    str.push(\"client-request-id=\" + encodeURIComponent(serverRequestParams.correlationId));\n    return str;\n  };\n  /**\n   * append the required scopes: https://openid.net/specs/openid-connect-basic-1_0.html#Scopes\n   * @param scopes\n   */\n\n\n  UrlUtils.translateclientIdUsedInScope = function (scopes, clientId) {\n    var clientIdIndex = scopes.indexOf(clientId);\n\n    if (clientIdIndex >= 0) {\n      scopes.splice(clientIdIndex, 1);\n\n      if (scopes.indexOf(\"openid\") === -1) {\n        scopes.push(\"openid\");\n      }\n\n      if (scopes.indexOf(\"profile\") === -1) {\n        scopes.push(\"profile\");\n      }\n    }\n  };\n  /**\n   * Returns current window URL as redirect uri\n   */\n\n\n  UrlUtils.getDefaultRedirectUri = function () {\n    return window.location.href.split(\"?\")[0].split(\"#\")[0];\n  };\n  /**\n   * Given a url like https://a:b/common/d?e=f#g, and a tenantId, returns https://a:b/tenantId/d\n   * @param href The url\n   * @param tenantId The tenant id to replace\n   */\n\n\n  UrlUtils.replaceTenantPath = function (url, tenantId) {\n    url = url.toLowerCase();\n    var urlObject = this.GetUrlComponents(url);\n    var pathArray = urlObject.PathSegments;\n\n    if (tenantId && pathArray.length !== 0 && (pathArray[0] === Constants.common || pathArray[0] === SSOTypes.ORGANIZATIONS)) {\n      pathArray[0] = tenantId;\n    }\n\n    return this.constructAuthorityUriFromObject(urlObject, pathArray);\n  };\n\n  UrlUtils.constructAuthorityUriFromObject = function (urlObject, pathArray) {\n    return this.CanonicalizeUri(urlObject.Protocol + \"//\" + urlObject.HostNameAndPort + \"/\" + pathArray.join(\"/\"));\n  };\n  /**\n   * Parses out the components from a url string.\n   * @returns An object with the various components. Please cache this value insted of calling this multiple times on the same url.\n   */\n\n\n  UrlUtils.GetUrlComponents = function (url) {\n    if (!url) {\n      throw \"Url required\";\n    } // https://gist.github.com/curtisz/11139b2cfcaef4a261e0\n\n\n    var regEx = RegExp(\"^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\\\?([^#]*))?(#(.*))?\");\n    var match = url.match(regEx);\n\n    if (!match || match.length < 6) {\n      throw \"Valid url required\";\n    }\n\n    var urlComponents = {\n      Protocol: match[1],\n      HostNameAndPort: match[4],\n      AbsolutePath: match[5]\n    };\n    var pathSegments = urlComponents.AbsolutePath.split(\"/\");\n    pathSegments = pathSegments.filter(function (val) {\n      return val && val.length > 0;\n    }); // remove empty elements\n\n    urlComponents.PathSegments = pathSegments;\n    return urlComponents;\n  };\n  /**\n   * Given a url or path, append a trailing slash if one doesnt exist\n   *\n   * @param url\n   */\n\n\n  UrlUtils.CanonicalizeUri = function (url) {\n    if (url) {\n      url = url.toLowerCase();\n    }\n\n    if (url && !UrlUtils.endsWith(url, \"/\")) {\n      url += \"/\";\n    }\n\n    return url;\n  };\n  /**\n   * Checks to see if the url ends with the suffix\n   * Required because we are compiling for es5 instead of es6\n   * @param url\n   * @param str\n   */\n  // TODO: Rename this, not clear what it is supposed to do\n\n\n  UrlUtils.endsWith = function (url, suffix) {\n    if (!url || !suffix) {\n      return false;\n    }\n\n    return url.indexOf(suffix, url.length - suffix.length) !== -1;\n  };\n  /**\n   * Utils function to remove the login_hint and domain_hint from the i/p extraQueryParameters\n   * @param url\n   * @param name\n   */\n\n\n  UrlUtils.urlRemoveQueryStringParameter = function (url, name) {\n    if (StringUtils.isEmpty(url)) {\n      return url;\n    }\n\n    var regex = new RegExp(\"(\\\\&\" + name + \"=)[^\\&]+\");\n    url = url.replace(regex, \"\"); // name=value&\n\n    regex = new RegExp(\"(\" + name + \"=)[^\\&]+&\");\n    url = url.replace(regex, \"\"); // name=value\n\n    regex = new RegExp(\"(\" + name + \"=)[^\\&]+\");\n    url = url.replace(regex, \"\");\n    return url;\n  };\n  /**\n   * @hidden\n   * @ignore\n   *\n   * Returns the anchor part(#) of the URL\n   */\n\n\n  UrlUtils.getHashFromUrl = function (urlStringOrFragment) {\n    var hashIndex1 = urlStringOrFragment.indexOf(\"#\");\n    var hashIndex2 = urlStringOrFragment.indexOf(\"#/\");\n\n    if (hashIndex2 > -1) {\n      return urlStringOrFragment.substring(hashIndex2 + 2);\n    } else if (hashIndex1 > -1) {\n      return urlStringOrFragment.substring(hashIndex1 + 1);\n    }\n\n    return urlStringOrFragment;\n  };\n  /**\n   * @hidden\n   * Check if the url contains a hash with known properties\n   * @ignore\n   */\n\n\n  UrlUtils.urlContainsHash = function (urlString) {\n    var parameters = UrlUtils.deserializeHash(urlString);\n    return parameters.hasOwnProperty(ServerHashParamKeys.ERROR_DESCRIPTION) || parameters.hasOwnProperty(ServerHashParamKeys.ERROR) || parameters.hasOwnProperty(ServerHashParamKeys.ACCESS_TOKEN) || parameters.hasOwnProperty(ServerHashParamKeys.ID_TOKEN);\n  };\n  /**\n   * @hidden\n   * Returns deserialized portion of URL hash\n   * @ignore\n   */\n\n\n  UrlUtils.deserializeHash = function (urlFragment) {\n    var hash = UrlUtils.getHashFromUrl(urlFragment);\n    return CryptoUtils.deserialize(hash);\n  };\n  /**\n   * @ignore\n   * @param {string} URI\n   * @returns {string} host from the URI\n   *\n   * extract URI from the host\n   */\n\n\n  UrlUtils.getHostFromUri = function (uri) {\n    // remove http:// or https:// from uri\n    var extractedUri = String(uri).replace(/^(https?:)\\/\\//, \"\");\n    extractedUri = extractedUri.split(\"/\")[0];\n    return extractedUri;\n  };\n\n  return UrlUtils;\n}();\n\nexport { UrlUtils };","map":{"version":3,"sources":["../../src/utils/UrlUtils.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["/*\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License.\n */\nimport { Constants, SSOTypes, ServerHashParamKeys } from \"./Constants\";\nimport { ScopeSet } from \"../ScopeSet\";\nimport { StringUtils } from \"./StringUtils\";\nimport { CryptoUtils } from \"./CryptoUtils\";\n/**\n * @hidden\n */\nvar UrlUtils = /** @class */ (function () {\n    function UrlUtils() {\n    }\n    /**\n     * generates the URL with QueryString Parameters\n     * @param scopes\n     */\n    UrlUtils.createNavigateUrl = function (serverRequestParams) {\n        var str = this.createNavigationUrlString(serverRequestParams);\n        var authEndpoint = serverRequestParams.authorityInstance.AuthorizationEndpoint;\n        // if the endpoint already has queryparams, lets add to it, otherwise add the first one\n        if (authEndpoint.indexOf(\"?\") < 0) {\n            authEndpoint += \"?\";\n        }\n        else {\n            authEndpoint += \"&\";\n        }\n        var requestUrl = \"\" + authEndpoint + str.join(\"&\");\n        return requestUrl;\n    };\n    /**\n     * Generate the array of all QueryStringParams to be sent to the server\n     * @param scopes\n     */\n    UrlUtils.createNavigationUrlString = function (serverRequestParams) {\n        var scopes = serverRequestParams.scopes;\n        if (scopes.indexOf(serverRequestParams.clientId) === -1) {\n            scopes.push(serverRequestParams.clientId);\n        }\n        var str = [];\n        str.push(\"response_type=\" + serverRequestParams.responseType);\n        this.translateclientIdUsedInScope(scopes, serverRequestParams.clientId);\n        str.push(\"scope=\" + encodeURIComponent(ScopeSet.parseScope(scopes)));\n        str.push(\"client_id=\" + encodeURIComponent(serverRequestParams.clientId));\n        str.push(\"redirect_uri=\" + encodeURIComponent(serverRequestParams.redirectUri));\n        str.push(\"state=\" + encodeURIComponent(serverRequestParams.state));\n        str.push(\"nonce=\" + encodeURIComponent(serverRequestParams.nonce));\n        str.push(\"client_info=1\");\n        str.push(\"x-client-SKU=\" + serverRequestParams.xClientSku);\n        str.push(\"x-client-Ver=\" + serverRequestParams.xClientVer);\n        if (serverRequestParams.promptValue) {\n            str.push(\"prompt=\" + encodeURIComponent(serverRequestParams.promptValue));\n        }\n        if (serverRequestParams.claimsValue) {\n            str.push(\"claims=\" + encodeURIComponent(serverRequestParams.claimsValue));\n        }\n        if (serverRequestParams.queryParameters) {\n            str.push(serverRequestParams.queryParameters);\n        }\n        if (serverRequestParams.extraQueryParameters) {\n            str.push(serverRequestParams.extraQueryParameters);\n        }\n        str.push(\"client-request-id=\" + encodeURIComponent(serverRequestParams.correlationId));\n        return str;\n    };\n    /**\n     * append the required scopes: https://openid.net/specs/openid-connect-basic-1_0.html#Scopes\n     * @param scopes\n     */\n    UrlUtils.translateclientIdUsedInScope = function (scopes, clientId) {\n        var clientIdIndex = scopes.indexOf(clientId);\n        if (clientIdIndex >= 0) {\n            scopes.splice(clientIdIndex, 1);\n            if (scopes.indexOf(\"openid\") === -1) {\n                scopes.push(\"openid\");\n            }\n            if (scopes.indexOf(\"profile\") === -1) {\n                scopes.push(\"profile\");\n            }\n        }\n    };\n    /**\n     * Returns current window URL as redirect uri\n     */\n    UrlUtils.getDefaultRedirectUri = function () {\n        return window.location.href.split(\"?\")[0].split(\"#\")[0];\n    };\n    /**\n     * Given a url like https://a:b/common/d?e=f#g, and a tenantId, returns https://a:b/tenantId/d\n     * @param href The url\n     * @param tenantId The tenant id to replace\n     */\n    UrlUtils.replaceTenantPath = function (url, tenantId) {\n        url = url.toLowerCase();\n        var urlObject = this.GetUrlComponents(url);\n        var pathArray = urlObject.PathSegments;\n        if (tenantId && (pathArray.length !== 0 && (pathArray[0] === Constants.common || pathArray[0] === SSOTypes.ORGANIZATIONS))) {\n            pathArray[0] = tenantId;\n        }\n        return this.constructAuthorityUriFromObject(urlObject, pathArray);\n    };\n    UrlUtils.constructAuthorityUriFromObject = function (urlObject, pathArray) {\n        return this.CanonicalizeUri(urlObject.Protocol + \"//\" + urlObject.HostNameAndPort + \"/\" + pathArray.join(\"/\"));\n    };\n    /**\n     * Parses out the components from a url string.\n     * @returns An object with the various components. Please cache this value insted of calling this multiple times on the same url.\n     */\n    UrlUtils.GetUrlComponents = function (url) {\n        if (!url) {\n            throw \"Url required\";\n        }\n        // https://gist.github.com/curtisz/11139b2cfcaef4a261e0\n        var regEx = RegExp(\"^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\\\?([^#]*))?(#(.*))?\");\n        var match = url.match(regEx);\n        if (!match || match.length < 6) {\n            throw \"Valid url required\";\n        }\n        var urlComponents = {\n            Protocol: match[1],\n            HostNameAndPort: match[4],\n            AbsolutePath: match[5]\n        };\n        var pathSegments = urlComponents.AbsolutePath.split(\"/\");\n        pathSegments = pathSegments.filter(function (val) { return val && val.length > 0; }); // remove empty elements\n        urlComponents.PathSegments = pathSegments;\n        return urlComponents;\n    };\n    /**\n     * Given a url or path, append a trailing slash if one doesnt exist\n     *\n     * @param url\n     */\n    UrlUtils.CanonicalizeUri = function (url) {\n        if (url) {\n            url = url.toLowerCase();\n        }\n        if (url && !UrlUtils.endsWith(url, \"/\")) {\n            url += \"/\";\n        }\n        return url;\n    };\n    /**\n     * Checks to see if the url ends with the suffix\n     * Required because we are compiling for es5 instead of es6\n     * @param url\n     * @param str\n     */\n    // TODO: Rename this, not clear what it is supposed to do\n    UrlUtils.endsWith = function (url, suffix) {\n        if (!url || !suffix) {\n            return false;\n        }\n        return url.indexOf(suffix, url.length - suffix.length) !== -1;\n    };\n    /**\n     * Utils function to remove the login_hint and domain_hint from the i/p extraQueryParameters\n     * @param url\n     * @param name\n     */\n    UrlUtils.urlRemoveQueryStringParameter = function (url, name) {\n        if (StringUtils.isEmpty(url)) {\n            return url;\n        }\n        var regex = new RegExp(\"(\\\\&\" + name + \"=)[^\\&]+\");\n        url = url.replace(regex, \"\");\n        // name=value&\n        regex = new RegExp(\"(\" + name + \"=)[^\\&]+&\");\n        url = url.replace(regex, \"\");\n        // name=value\n        regex = new RegExp(\"(\" + name + \"=)[^\\&]+\");\n        url = url.replace(regex, \"\");\n        return url;\n    };\n    /**\n     * @hidden\n     * @ignore\n     *\n     * Returns the anchor part(#) of the URL\n     */\n    UrlUtils.getHashFromUrl = function (urlStringOrFragment) {\n        var hashIndex1 = urlStringOrFragment.indexOf(\"#\");\n        var hashIndex2 = urlStringOrFragment.indexOf(\"#/\");\n        if (hashIndex2 > -1) {\n            return urlStringOrFragment.substring(hashIndex2 + 2);\n        }\n        else if (hashIndex1 > -1) {\n            return urlStringOrFragment.substring(hashIndex1 + 1);\n        }\n        return urlStringOrFragment;\n    };\n    /**\n     * @hidden\n     * Check if the url contains a hash with known properties\n     * @ignore\n     */\n    UrlUtils.urlContainsHash = function (urlString) {\n        var parameters = UrlUtils.deserializeHash(urlString);\n        return (parameters.hasOwnProperty(ServerHashParamKeys.ERROR_DESCRIPTION) ||\n            parameters.hasOwnProperty(ServerHashParamKeys.ERROR) ||\n            parameters.hasOwnProperty(ServerHashParamKeys.ACCESS_TOKEN) ||\n            parameters.hasOwnProperty(ServerHashParamKeys.ID_TOKEN));\n    };\n    /**\n     * @hidden\n     * Returns deserialized portion of URL hash\n     * @ignore\n     */\n    UrlUtils.deserializeHash = function (urlFragment) {\n        var hash = UrlUtils.getHashFromUrl(urlFragment);\n        return CryptoUtils.deserialize(hash);\n    };\n    /**\n     * @ignore\n     * @param {string} URI\n     * @returns {string} host from the URI\n     *\n     * extract URI from the host\n     */\n    UrlUtils.getHostFromUri = function (uri) {\n        // remove http:// or https:// from uri\n        var extractedUri = String(uri).replace(/^(https?:)\\/\\//, \"\");\n        extractedUri = extractedUri.split(\"/\")[0];\n        return extractedUri;\n    };\n    return UrlUtils;\n}());\nexport { UrlUtils };\n//# sourceMappingURL=UrlUtils.js.map"]},"metadata":{},"sourceType":"module"}