{"ast":null,"code":"var _jsxFileName = \"D:\\\\Assignment\\\\graph-tutorial\\\\src\\\\AddUser.tsx\";\nimport React from 'react';\nimport { Form, Input, Button, Switch } from 'antd';\nimport 'antd/dist/antd.css';\nimport { Row, Col } from 'antd';\nimport { createUser } from './GraphService';\nimport { config } from './Config';\nimport { UserAgentApplication } from 'msal';\n\nconst AddUser = () => {\n  const userAgentApplication = new UserAgentApplication({\n    auth: {\n      clientId: config.appId,\n      redirectUri: config.redirectUri\n    },\n    cache: {\n      cacheLocation: \"sessionStorage\",\n      storeAuthStateInCookie: true\n    }\n  });\n\n  const isInteractionRequired = error => {\n    if (!error.message || error.message.length <= 0) {\n      return false;\n    }\n\n    return error.message.indexOf('consent_required') > -1 || error.message.indexOf('interaction_required') > -1 || error.message.indexOf('login_required') > -1;\n  };\n\n  const getAccessToken = async scopes => {\n    try {\n      var silentResult = await userAgentApplication.acquireTokenSilent({\n        scopes: scopes\n      });\n      return silentResult.accessToken;\n    } catch (err) {\n      // If a silent request fails, it may be because the user needs\n      // to login or grant consent to one or more of the requested scopes\n      if (isInteractionRequired(err)) {\n        var interactiveResult = await userAgentApplication.acquireTokenPopup({\n          scopes: scopes\n        });\n        return interactiveResult.accessToken;\n      } else {\n        throw err;\n      }\n    }\n  };\n\n  const passwordProfile = {\n    \"forceChangePasswordNextSignIn\": true,\n    \"forceChangePasswordNextSignInWithMfa\": false,\n    \"password\": \"\"\n  };\n\n  const getMailNickName = email => {\n    let nickName = email.split('@');\n    return nickName;\n  };\n\n  const onFinish = async values => {\n    try {\n      const accessToken = await getAccessToken(config.scopes);\n      const {\n        userPrincipalName\n      } = values;\n      let mailNickname = getMailNickName(userPrincipalName)[0];\n      const requestBody = { ...values,\n        mailNickname,\n        passwordProfile: { ...passwordProfile\n        }\n      };\n      console.log('access', accessToken);\n      const res = createUser(accessToken, requestBody);\n      console.log(requestBody);\n      console.log(res);\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Col, {\n    span: 6,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 17\n    }\n  }), /*#__PURE__*/React.createElement(Col, {\n    span: 12,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(Form, {\n    onFinish: onFinish,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(Form.Item, {\n    label: \"Account Enable\",\n    name: \"accountEnabled\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(Switch, {\n    checkedChildren: \"Yes\",\n    unCheckedChildren: \"No\",\n    defaultChecked: false,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 29\n    }\n  })), /*#__PURE__*/React.createElement(Form.Item, {\n    label: \"Display Name\",\n    name: \"displayName\",\n    rules: [{\n      required: true,\n      message: 'Please input your Display Name!'\n    }],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(Input, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 29\n    }\n  })), /*#__PURE__*/React.createElement(Form.Item, {\n    label: \"Email\",\n    name: \"userPrincipalName\",\n    rules: [{\n      message: 'Please input your Email'\n    }],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(Input, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 29\n    }\n  })), /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 25\n    }\n  }), /*#__PURE__*/React.createElement(Form.Item, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    type: \"primary\",\n    htmlType: \"submit\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 29\n    }\n  }, \"Create\")))), /*#__PURE__*/React.createElement(Col, {\n    span: 6,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 17\n    }\n  })));\n};\n\nexport default AddUser;","map":{"version":3,"sources":["D:/Assignment/graph-tutorial/src/AddUser.tsx"],"names":["React","Form","Input","Button","Switch","Row","Col","createUser","config","UserAgentApplication","AddUser","userAgentApplication","auth","clientId","appId","redirectUri","cache","cacheLocation","storeAuthStateInCookie","isInteractionRequired","error","message","length","indexOf","getAccessToken","scopes","silentResult","acquireTokenSilent","accessToken","err","interactiveResult","acquireTokenPopup","passwordProfile","getMailNickName","email","nickName","split","onFinish","values","userPrincipalName","mailNickname","requestBody","console","log","res","required"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport { Form, Input, Button, Switch } from 'antd';\r\nimport 'antd/dist/antd.css';\r\nimport { Row, Col } from 'antd';\r\nimport { createUser } from './GraphService';\r\nimport { config } from './Config';\r\nimport { UserAgentApplication } from 'msal';\r\n\r\n\r\nconst AddUser = () => {\r\n\r\n    const userAgentApplication = new UserAgentApplication({\r\n        auth: {\r\n            clientId: config.appId,\r\n            redirectUri: config.redirectUri\r\n        },\r\n        cache: {\r\n            cacheLocation: \"sessionStorage\",\r\n            storeAuthStateInCookie: true\r\n        }\r\n    });\r\n\r\n    const isInteractionRequired = (error: Error): boolean => {\r\n        if (!error.message || error.message.length <= 0) {\r\n            return false;\r\n        }\r\n\r\n        return (\r\n            error.message.indexOf('consent_required') > -1 ||\r\n            error.message.indexOf('interaction_required') > -1 ||\r\n            error.message.indexOf('login_required') > -1\r\n        );\r\n    }\r\n\r\n    const getAccessToken = async (scopes: string[]) => {\r\n\r\n        try {\r\n            var silentResult = await userAgentApplication.acquireTokenSilent({\r\n                scopes: scopes\r\n            });\r\n            return silentResult.accessToken;\r\n        } catch (err) {\r\n            // If a silent request fails, it may be because the user needs\r\n            // to login or grant consent to one or more of the requested scopes\r\n            if (isInteractionRequired(err)) {\r\n                var interactiveResult = await userAgentApplication.acquireTokenPopup({\r\n                    scopes: scopes\r\n                });\r\n\r\n                return interactiveResult.accessToken;\r\n            } else {\r\n                throw err;\r\n            }\r\n        }\r\n    }\r\n\r\n    const passwordProfile = {\r\n        \"forceChangePasswordNextSignIn\": true,\r\n        \"forceChangePasswordNextSignInWithMfa\": false,\r\n        \"password\": \"\"\r\n    }\r\n\r\n    const getMailNickName = (email: string) => {\r\n        let nickName = email.split('@');\r\n        return nickName;\r\n    }\r\n\r\n    const onFinish = async (values: any) => {\r\n        try {\r\n            const accessToken = await getAccessToken(config.scopes);\r\n            const { userPrincipalName } = values;\r\n            let mailNickname = getMailNickName(userPrincipalName)[0]\r\n            const requestBody = { ...values, mailNickname, passwordProfile: { ...passwordProfile } }\r\n\r\n            console.log('access', accessToken);\r\n            const res = createUser(accessToken, requestBody)\r\n            console.log(requestBody);\r\n            console.log(res);\r\n            \r\n        } catch (error) {\r\n\r\n            console.log(error);\r\n        }\r\n\r\n    };\r\n\r\n    return (\r\n        <>\r\n            <Row>\r\n                <Col span={6}></Col>\r\n                <Col span={12}>\r\n                    <Form\r\n                        onFinish={onFinish}\r\n                    >\r\n                        <Form.Item\r\n                            label='Account Enable'\r\n                            name='accountEnabled'>\r\n                            <Switch\r\n                                checkedChildren=\"Yes\" unCheckedChildren=\"No\" defaultChecked={false} />\r\n                        </Form.Item>\r\n\r\n                        <Form.Item\r\n                            label=\"Display Name\"\r\n                            name=\"displayName\"\r\n                            rules={[{ required: true, message: 'Please input your Display Name!' }]}\r\n                        >\r\n                            <Input />\r\n                        </Form.Item>\r\n                        <Form.Item\r\n                            label=\"Email\"\r\n                            name=\"userPrincipalName\"\r\n                            rules={[{ message: 'Please input your Email' }]}\r\n                        >\r\n                            <Input />\r\n                        </Form.Item>\r\n                        <br />\r\n                        <Form.Item>\r\n                            <Button type=\"primary\" htmlType=\"submit\">\r\n                                Create\r\n                            </Button>\r\n                        </Form.Item>\r\n                    </Form>\r\n                </Col>\r\n                <Col span={6}></Col>\r\n            </Row>\r\n\r\n        </>\r\n    );\r\n};\r\n\r\nexport default AddUser;"]},"metadata":{},"sourceType":"module"}